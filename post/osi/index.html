
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <script type="text/javascript">
    var host = "wsgzao.github.io";
    if ((host == window.location.host) && (window.location.protocol != "https:"))
        window.location.protocol = "https";
  </script> 
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LJ3PMGPVCK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LJ3PMGPVCK');
</script>
  
    <title>OSI 七层模型与 TCP/IP 四层模型 | HelloDog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="wsgzao">
    

    
    <meta name="description" content="OSI 七层模型与 TCP/IP 四层模型">
<meta property="og:type" content="article">
<meta property="og:title" content="OSI 七层模型与 TCP&#x2F;IP 四层模型">
<meta property="og:url" content="https://wsgzao.github.io/post/osi/index.html">
<meta property="og:site_name" content="HelloDog">
<meta property="og:description" content="OSI 七层模型与 TCP/IP 四层模型">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20190625105716.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20190625113518.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20190627120046.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20190704144039.png">
<meta property="og:updated_time" content="2019-07-04T06:41:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="OSI 七层模型与 TCP&#x2F;IP 四层模型">
<meta name="twitter:description" content="OSI 七层模型与 TCP/IP 四层模型">
<meta name="twitter:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20190625105716.png">

    
    <link rel="alternative" href="/atom.xml" title="HelloDog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="HelloDog" title="HelloDog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="HelloDog">HelloDog</a></h1>
				<h2 class="blog-motto">Keep Calm and Carry On</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页 | Home</a></li>
					
						<li><a href="/index/">索引 | Index</a></li>
					
						<li><a href="/archives/">归档 | Archives</a></li>
					
						<li><a href="/about/">简介 | About</a></li>
					
					<li>
 					
						<form class="search">
							<label>Search</label>
						<input type="text" id="search" class="st-default-search-input" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/post/osi/" title="OSI 七层模型与 TCP/IP 四层模型" itemprop="url">OSI 七层模型与 TCP/IP 四层模型</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="wsgzao" target="_blank" itemprop="author">wsgzao</a>
		
  <p class="article-time">
    <time datetime="2019-06-20T06:59:49.000Z" itemprop="datePublished"> 发表于 2019-06-20</time>
    
  </p>
</header>
	<div class="article-content">
<!-- 		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更新历史"><span class="toc-number">2.</span> <span class="toc-text">更新历史</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSI-七层模型"><span class="toc-number">3.</span> <span class="toc-text">OSI 七层模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-IP-协议族常用协议"><span class="toc-number">3.1.</span> <span class="toc-text">TCP/IP 协议族常用协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP-IP-四层模型"><span class="toc-number">4.</span> <span class="toc-text">TCP/IP 四层模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-IP-三次握手"><span class="toc-number">4.1.</span> <span class="toc-text">TCP/IP 三次握手</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-IP-四次挥手"><span class="toc-number">4.2.</span> <span class="toc-text">TCP/IP 四次挥手</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q-amp-A"><span class="toc-number">5.</span> <span class="toc-text">Q &amp; A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q-A"><span class="toc-number">6.</span> <span class="toc-text">Q/A</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么建立连接是三次握手，而关闭连接却是四次挥手呢？"><span class="toc-number">6.1.</span> <span class="toc-text">为什么建立连接是三次握手，而关闭连接却是四次挥手呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么建立连接要三次握手？"><span class="toc-number">6.2.</span> <span class="toc-text">为什么建立连接要三次握手？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SYN-攻击"><span class="toc-number">6.3.</span> <span class="toc-text">SYN 攻击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么-TIME-WAIT-状态需要经过-2MSL-最大报文段生存时间-才能返回到-CLOSE-状态？"><span class="toc-number">6.4.</span> <span class="toc-text">为什么 TIME_WAIT 状态需要经过 2MSL (最大报文段生存时间) 才能返回到 CLOSE 状态？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文章"><span class="toc-number">7.</span> <span class="toc-text">参考文章</span></a></li></ol>
		
		</div>
		 -->
		<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>偶然从微信上看到《两地书》–K8s 基础知识 这篇文章，虽然是概括，但是配图和基础介绍都不错，本文单独把 OSI 七层模型与 TCP/IP 四层模型 方便自己回顾。</p>
<blockquote>
<p>OSI 七层模型与 TCP/IP 四层模型</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2019 年 06 月 26 日 - 更新 TCP/IP 的三次握手与四次挥手<br>2019 年 06 月 20 日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/osi/">https://wsgzao.github.io/post/osi/</a></p>
<p><strong> 扩展阅读 </strong></p>
<p>《两地书》–K8s 基础知识<br><a href="https://mp.weixin.qq.com/s?__biz=MzUzNjAxODg4MQ==&amp;mid=2247483841&amp;idx=1&amp;sn=c236d6829a2cce8ad56236bf75085bbf&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzUzNjAxODg4MQ==&amp;mid=2247483841&amp;idx=1&amp;sn=c236d6829a2cce8ad56236bf75085bbf&amp;scene=21#wechat_redirect</a></p>
<p>简单的回顾下 TCP/IP 的三次握手与四次挥手 - <a href="https://blog.ansheng.me/article/tcp-ip-three-handshakes-and-four-waving/" target="_blank" rel="noopener">https://blog.ansheng.me/article/tcp-ip-three-handshakes-and-four-waving/</a></p>
<hr>
<h2 id="OSI-七层模型"><a href="#OSI-七层模型" class="headerlink" title="OSI 七层模型"></a>OSI 七层模型</h2><p>OSI 模型（Open System Interconnection Reference Model，缩写为 OSI）, 全名 “开放式系统互联通信参考模型”，是一个试图使各种计算机在全世界范围内互联为网络的标准框架。1983 年，国际标准组织（ISO）发布了著名的 ISO/IEC 7498 标准，它定义了网络互联的 7 层框架，也就是开放式系统互联参考模型。</p>
<p>7 层是指 OSI 七层协议模型，主要是：</p>
<ul>
<li>应用层（Application）</li>
<li>表示层（Presentation）</li>
<li>会话层（Session）</li>
<li>传输层（Transport）</li>
<li>网络层（Network）</li>
<li>数据链路层（Data Link）</li>
<li>物理层（Physical）</li>
</ul>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20190625105716.png" alt=""></p>
<p>第 7 层应用层 (Application Layer)</p>
<p><strong> 主要功能：</strong> 为应用软件提供接口，使应用程序能够使用网络服务<br><strong> 典型设备：</strong> 网关<br><strong> 典型协议、标准和应用：</strong> http(80)、ftp(20/21)、smtp(25)、pop3(110)、telnet(23)、dns(53)</p>
<p>第 6 层表示层 (Presentation Layer)</p>
<p><strong> 主要功能：</strong> 数据的解码和编码，数据的加密和解密，数据的压缩和解压缩<br><strong> 典型设备：</strong> 网关<br><strong> 典型协议、标准和应用：</strong> ASCLL、PICT、TIFF、JPEG、 MIDI、MPEG</p>
<p>第 5 层会话层 (Session Layer)</p>
<p><strong> 主要功能：</strong> 建立、维护、管理应用程序之间的会话<br><strong> 典型设备：</strong> 网关<br><strong> 典型协议、标准和应用：</strong> RPC、SQL、NFS 、X WINDOWS、ASP</p>
<p>第 4 层传输层 (Transport Layer)</p>
<p><strong> 主要功能：</strong> 负责建立端到端的链接，保证保温在端到端之间的传输<br><strong> 典型设备：</strong> 网关<br><strong> 典型协议、标准和应用：</strong> TCP、UDP、SPX</p>
<p>第 3 层网络层 (Network Layer)</p>
<p><strong> 主要功能：</strong> 负责将分组数据从源端传输到目的端，网络层的主要作用就是路由和寻址<br><strong> 典型设备：</strong> 路由器<br><strong> 典型协议、标准和应用：</strong> IP、IPX、APPLETALK、ICMP</p>
<p>第 2 层数据链接层 (Data Link Layer)</p>
<p><strong> 主要功能：</strong> 在不可靠的物理链路上，提供可靠的数据传输服务<br><strong> 典型设备：</strong> 交换机、网桥、网卡<br><strong> 典型协议、标准和应用：</strong> 802.2、802.3ATM、HDLC、FRAME RELAY</p>
<p>第 1 层物理层 (Physical Layer)</p>
<p><strong> 主要功能：</strong> 利用传输介质为数据链路层提供物理连接，实现比特流的透明传输<br><strong> 典型设备：</strong> 集线器、中继器<br><strong> 典型协议、标准和应用：</strong> V.35、EIA/TIA-232</p>
<h3 id="TCP-IP-协议族常用协议"><a href="#TCP-IP-协议族常用协议" class="headerlink" title="TCP/IP 协议族常用协议"></a>TCP/IP 协议族常用协议</h3><p><strong> 应用层：</strong> TFTP，HTTP，SNMP，FTP，SMTP，DNS，Telnet 等等<br><strong> 传输层：</strong> TCP，UDP<br><strong> 网络层：</strong> IP，ICMP，OSPF，EIGRP，IGMP<br><strong> 数据链路层：</strong> SLIP，CSLIP，PPP，MTU</p>
<h2 id="TCP-IP-四层模型"><a href="#TCP-IP-四层模型" class="headerlink" title="TCP/IP 四层模型"></a>TCP/IP 四层模型</h2><p>互联网协议族（英语：Internet Protocol Suite，缩写为 IPS），是一个网络通信模型，以及一整个网络传输协议家族，为互联网的基础通信架构。它常被通称为 TCP/IP 协议族（英语：TCP/IP Protocol Suite，或 TCP/IP Protocols），简称 TCP/IP。因为这个协议家族的两个核心协议，包括 TCP（传输控制协议）和 IP（网际协议），为这个家族中最早通过的标准 。由于在网络通讯协议普遍采用分层的结构，当多个层次的协议共同工作时，类似计算机科学中的堆栈，因此又被称为 TCP/IP 协议栈（英语：TCP/IP Protocol Stack）。这些协议最早发源于美国国防部（缩写为 DoD）的 ARPA 网项目，因此也被称作 DoD 模型（DoD Model）。这个协议套组由互联网工程任务组负责维护。</p>
<p>TCP/IP 提供点对点的链接机制，将数据应该如何封装、定址、传输、路由以及在目的地如何接收，都加以标准化。它将软件通信过程抽象化为四个抽象层，采取协议堆栈的方式，分别实现出不同通信协议。协议套组下的各种协议，依其功能不同，被分别归属到这四个层次结构之中，常被视为是简化的七层 OSI 模型</p>
<p>TCP/IP 和 OSI 模型组并不能精确的匹配，但是我们可以尽可能的参考 OSI 模型并在其中找到 TCP/IP 的对应位置。如上图所示，我们已经标出了 TCP/IP 对应的四层位置所在。通常人们认为 OSI 模型最上面三层（应用层、表示层、会话层）在 TCP/IP 中是一个应用层。由于 TCP/IP 有一个相对比较弱的会话层，由 TCP 和 RTP 下的打开和关闭连接组成，并在 TCP/UDP 下的各种应用提供不同的端口号，这些功能被单个的应用程序添加。</p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20190625113518.png" alt=""></p>
<h3 id="TCP-IP-三次握手"><a href="#TCP-IP-三次握手" class="headerlink" title="TCP/IP 三次握手"></a>TCP/IP 三次握手</h3><p>在建立 TCP 连接之前需要进行三次握手，以便于链接到服务器，如果要断开服务器需要进行四次挥手，具体流程如下。</p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20190627120046.png" alt=""></p>
<ul>
<li><strong> 第一次握手：</strong> Client 将标志位 syn 设置为 1，随机产生一个 Number 值 seq=100，并将数据发送给 Server，Client 进入 SYN_SENT 状态，等待 Server 确认；</li>
<li><strong> 第二次握手：</strong> Server 收到数据包后 Client 设置的标志位 syn=1 知道 Client 要求建立连接，Server 将标志位 syn 和 ack 都置为 1，并且发送一个确认序号 ack=100+1，然后随机产生一个值 seq=130，并将该数据包发送给 CLient 以确认连接请求，Server 进入 SYN_RCVD 状态。</li>
<li><strong> 第三次握手：</strong> Client 收到确认后，检查 ack 状态是否为 100+1，ACK 是否为 1，如果正确则将标志位 ACK 置为 1，ack=130+1，并将该数据包发送给 Server，Server 检查 ack 是否为 130+1，ACK 是否为 1，如果正确则连接建立成功，Client 和 Server 进入 ESTABLISHED 状态，完成三次握手，随后 Client 与 Server 之间可以开始传输数据了。</li>
</ul>
<p>一个完整的三次握手也就是 <strong> 请求 — 应答 — 再次确认 </strong></p>
<h3 id="TCP-IP-四次挥手"><a href="#TCP-IP-四次挥手" class="headerlink" title="TCP/IP 四次挥手"></a>TCP/IP 四次挥手</h3><p>为什么要挥手，简单点来说就是既然建立了链接，那么肯定还要断开连接吖，连接总不能一直占用吧，这样多浪费系统该资源，下面让我们来看看四次挥手的流程。</p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20190704144039.png" alt=""></p>
<ul>
<li><strong> 第一次挥手：</strong> Client 发送一个 FIN，用来关闭 Client 到 Server 的数据传送，Client 进入 FIN_WAIT_1 状态。</li>
<li><strong> 第二次挥手：</strong> Server 收到 FIN 后，发送一个 ACK 给 Client，确认序号为 ack=100+1（与 SYN 相同，一个 FIN 占用一个序号），Server 进入 CLOSE_WAIT 状态。</li>
<li><strong> 第三次挥手：</strong> Server 发送一个 FIN，用来关闭 Server 到 Client 的数据传送，Server 进入 LAST_ACK 状态。</li>
<li><strong> 第四次挥手：</strong> Client 收到 FIN 后，Client 进入 TIME_WAIT 状态，接着发送一个 ACK 给 Server，确认序号为 131+1，Server 进入 CLOSED 状态，完成四次挥手。</li>
</ul>
<h2 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q &amp; A"></a>Q &amp; A</h2><ol>
<li><strong> 第一次挥手：</strong> Client 发送一个 FIN，用来关闭 Client 到 Server 的数据传送，Client 进入 FIN_WAIT_1 状态。</li>
<li><strong> 第二次挥手：</strong> Server 收到 FIN 后，发送一个 ACK 给 Client，确认序号为 ack=100+1（与 SYN 相同，一个 FIN 占用一个序号），Server 进入 CLOSE_WAIT 状态。</li>
<li><strong> 第三次挥手：</strong> Server 发送一个 FIN，用来关闭 Server 到 Client 的数据传送，Server 进入 LAST_ACK 状态。</li>
<li><strong> 第四次挥手：</strong> Client 收到 FIN 后，Client 进入 TIME_WAIT 状态，接着发送一个 ACK 给 Server，确认序号为 131+1，Server 进入 CLOSED 状态，完成四次挥手。</li>
</ol>
<h2 id="Q-A"><a href="#Q-A" class="headerlink" title="Q/A"></a>Q/A</h2><h3 id="为什么建立连接是三次握手，而关闭连接却是四次挥手呢？"><a href="#为什么建立连接是三次握手，而关闭连接却是四次挥手呢？" class="headerlink" title="为什么建立连接是三次握手，而关闭连接却是四次挥手呢？"></a>为什么建立连接是三次握手，而关闭连接却是四次挥手呢？</h3><p>这是因为服务端在 LISTEN 状态下，收到建立连接请求的 SYN 报文后，把 ACK 和 SYN 放在一个报文里发送给客户端。而关闭连接时，当收到对方的 FIN 报文时，仅仅表示对方不再发送数据了但是还能接收数据，己方也未必全部数据都发送给对方了，所以己方可以立即 close，也可以发送一些数据给对方后，再发送 FIN 报文给对方来表示同意现在关闭连接，因此，己方 ACK 和 FIN 一般都会分开发送。</p>
<h3 id="为什么建立连接要三次握手？"><a href="#为什么建立连接要三次握手？" class="headerlink" title="为什么建立连接要三次握手？"></a>为什么建立连接要三次握手？</h3><p><strong> 目的：</strong> 防止已经失效的连接请求到达服务端，创建无效的连接，浪费资源。<br><strong> 说明：</strong> 当客户端发出的第一个连接请求在网络上的某个节点被滞留了（网络会存在许多不可靠的因素），过一段时间后突然又到达了服务端，服务端误以为这是一个新的建立连接的请求，于是就会向客户端发出确认包并建立连接。<br>实际上客户端当前并没有发出创建连接的请求，就会丢弃服务端的确认包。而服务端却创建了连接并等待客户端发送数据，浪费了相关的资源。</p>
<h3 id="SYN-攻击"><a href="#SYN-攻击" class="headerlink" title="SYN 攻击"></a>SYN 攻击</h3><p>在三次握手过程中，服务器 <code>发送 SYN-ACK 之后，收到客户端的 ACK 之前</code> 的 TCP 连接称为半连接 (half-open connect)。此时服务器处于 SYN_RECV 状态，当收到 ACK 后，服务器转入 ESTABLISHED 状态.</p>
<p>SYN 攻击就是：攻击客户端在短时间内伪造大量不存在的 IP 地址，向服务器不断地发送 SYN 包，服务器回复 ACK 确认包，并等待客户的确认从而建立连接。由于源地址是不存在的，不会再发送 ACK 确认包，所以服务器需要不断的重发直至超时，这些伪造的 SYN 包将长时间占用未连接队列，正常的 SYN 请求被丢弃，目标系统运行缓慢，严重者引起网络堵塞甚至系统瘫痪。</p>
<p>SYN 攻击是一个典型的 DDOS 攻击。检测 SYN 攻击非常的方便，当你在服务器上看到大量的半连接状态时，特别是源 IP 地址是随机的，基本上可以断定这是一次 SYN 攻击</p>
<h3 id="为什么-TIME-WAIT-状态需要经过-2MSL-最大报文段生存时间-才能返回到-CLOSE-状态？"><a href="#为什么-TIME-WAIT-状态需要经过-2MSL-最大报文段生存时间-才能返回到-CLOSE-状态？" class="headerlink" title="为什么 TIME_WAIT 状态需要经过 2MSL (最大报文段生存时间) 才能返回到 CLOSE 状态？"></a>为什么 TIME_WAIT 状态需要经过 2MSL (最大报文段生存时间) 才能返回到 CLOSE 状态？</h3><p>虽然按道理，四个报文都发送完毕，我们可以直接进入 CLOSE 状态了，但是我们必须假象网络是不可靠的，有可以最后一个 ACK 丢失。所以 TIME_WAIT 状态就是用来重发可能丢失的 ACK 报文。</p>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://coolshell.cn/articles/11564.html" target="_blank" rel="noopener">TCP 的那些事儿（上）</a><br><a href="https://coolshell.cn/articles/11609.html" target="_blank" rel="noopener">TCP 的那些事儿（下）</a></p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习-Study/">学习 | Study</a>
</div>


</div>



	<div class="article-share" id="share">
	
	  <div data-url="https://wsgzao.github.io/post/osi/" data-title="OSI 七层模型与 TCP/IP 四层模型 | HelloDog" data-tsina="" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/post/sre-vs-devops/" title="SRE 和 DevOps">
  <strong>上一篇：</strong><br/>
  <span>
  SRE 和 DevOps</span>
</a>
</div>


<div class="next">
<a href="/post/agile/"  title="敏捷开发 Agile 中 Scrum 与 Kanban 的实践心得">
 <strong>下一篇：</strong><br/> 
 <span>敏捷开发 Agile 中 Scrum 与 Kanban 的实践心得
</span>
</a>
</div>

</nav>

	

<section id="comments" class="comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更新历史"><span class="toc-number">2.</span> <span class="toc-text">更新历史</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSI-七层模型"><span class="toc-number">3.</span> <span class="toc-text">OSI 七层模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-IP-协议族常用协议"><span class="toc-number">3.1.</span> <span class="toc-text">TCP/IP 协议族常用协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP-IP-四层模型"><span class="toc-number">4.</span> <span class="toc-text">TCP/IP 四层模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-IP-三次握手"><span class="toc-number">4.1.</span> <span class="toc-text">TCP/IP 三次握手</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-IP-四次挥手"><span class="toc-number">4.2.</span> <span class="toc-text">TCP/IP 四次挥手</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q-amp-A"><span class="toc-number">5.</span> <span class="toc-text">Q &amp; A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q-A"><span class="toc-number">6.</span> <span class="toc-text">Q/A</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么建立连接是三次握手，而关闭连接却是四次挥手呢？"><span class="toc-number">6.1.</span> <span class="toc-text">为什么建立连接是三次握手，而关闭连接却是四次挥手呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么建立连接要三次握手？"><span class="toc-number">6.2.</span> <span class="toc-text">为什么建立连接要三次握手？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SYN-攻击"><span class="toc-number">6.3.</span> <span class="toc-text">SYN 攻击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么-TIME-WAIT-状态需要经过-2MSL-最大报文段生存时间-才能返回到-CLOSE-状态？"><span class="toc-number">6.4.</span> <span class="toc-text">为什么 TIME_WAIT 状态需要经过 2MSL (最大报文段生存时间) 才能返回到 CLOSE 状态？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文章"><span class="toc-number">7.</span> <span class="toc-text">参考文章</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="wsgzao" data-theme="medium"></div>
<script type="text/javascript" src="//lab.lepture.com/github-cards/widget.js" ></script>
</div>



  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/Hexo/" title="Hexo">Hexo<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/学习-Study/" title="学习 | Study">学习 | Study<sup>180</sup></a></li>
		  
		
		  
			<li><a href="/categories/生活-Life/" title="生活 | Life">生活 | Life<sup>16</sup></a></li>
		  
		
		  
			<li><a href="/categories/软件-Soft/" title="软件 | Soft">软件 | Soft<sup>5</sup></a></li>
		  
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.linkedin.com/in/aowang" target="_blank" title="LinkedIn">LinkedIn</a>
            
          </li>
        
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello, I&#39;m OX. This is my blog on GitHub. <br/>
			Keep Calm and Carry On.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/wsgzao" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		<a href="https://www.linkedin.com/in/aowang" target="_blank" class="icon-linkedin" title="linkedin"></a>
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2020 
		
		<a href="/about" target="_blank" title="wsgzao">wsgzao</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
        getSize();
        if (myWidth >= 1024) {
          c.click();
        }
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>




<script type="text/javascript">

var disqus_shortname = 'wsgzao';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>








<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-77732745-1', 'wsgzao.github.io');  
ga('send', 'pageview');
</script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?c2c5fc7d844d0973d9f77abd87f49c3c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- swiftype Begin -->

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','_4qDmKrBPn9Es3UvQHT4','2.0.0');
</script>

<!-- swiftype End -->

  </body>
</html>
