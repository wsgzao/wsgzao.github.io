
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <script type="text/javascript">
    var host = "wsgzao.github.io";
    if ((host == window.location.host) && (window.location.protocol != "https:"))
        window.location.protocol = "https";
  </script> 
  
    <title>使用tftpd32自动化网络安装esxi6.0u2和rhel6.7实践 | HelloDog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="wsgzao">
    

    
    <meta name="description" content="利用tftpd32快速搭建网络自动化搞机平台">
<meta property="og:type" content="article">
<meta property="og:title" content="使用tftpd32自动化网络安装esxi6.0u2和rhel6.7实践">
<meta property="og:url" content="https://wsgzao.github.io/post/tftpd32/index.html">
<meta property="og:site_name" content="HelloDog">
<meta property="og:description" content="利用tftpd32快速搭建网络自动化搞机平台">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/01/19/588083153cca3.jpg">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/01/19/5880832627c41.jpg">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/01/19/5880832f2bd2a.jpg">
<meta property="og:updated_time" content="2017-01-19T09:33:12.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用tftpd32自动化网络安装esxi6.0u2和rhel6.7实践">
<meta name="twitter:description" content="利用tftpd32快速搭建网络自动化搞机平台">
<meta name="twitter:image" content="https://ooo.0o0.ooo/2017/01/19/588083153cca3.jpg">

    
    <link rel="alternative" href="/atom.xml" title="HelloDog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="HelloDog" title="HelloDog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="HelloDog">HelloDog</a></h1>
				<h2 class="blog-motto">Keep Calm and Carry On</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页 | Home</a></li>
					
						<li><a href="/index/">索引 | Index</a></li>
					
						<li><a href="/archives/">归档 | Archives</a></li>
					
						<li><a href="/about/">简介 | About</a></li>
					
					<li>
 					
						<form class="search">
							<label>Search</label>
						<input type="text" id="search" class="st-default-search-input" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/post/tftpd32/" title="使用tftpd32自动化网络安装esxi6.0u2和rhel6.7实践" itemprop="url">使用tftpd32自动化网络安装esxi6.0u2和rhel6.7实践</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="wsgzao" target="_blank" itemprop="author">wsgzao</a>
		
  <p class="article-time">
    <time datetime="2017-01-19T06:59:49.000Z" itemprop="datePublished"> 发表于 2017-01-19</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更新历史"><span class="toc-number">2.</span> <span class="toc-text">更新历史</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3点建议"><span class="toc-number">3.</span> <span class="toc-text">3点建议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#esxi"><span class="toc-number">4.</span> <span class="toc-text">esxi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rhel"><span class="toc-number">5.</span> <span class="toc-text">rhel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tftpd32"><span class="toc-number">6.</span> <span class="toc-text">tftpd32</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TFTP"><span class="toc-number">6.1.</span> <span class="toc-text">TFTP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SNTP"><span class="toc-number">6.2.</span> <span class="toc-text">SNTP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DHCP"><span class="toc-number">6.3.</span> <span class="toc-text">DHCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Syslog"><span class="toc-number">6.4.</span> <span class="toc-text">Syslog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tftpd-server-Settings"><span class="toc-number">6.5.</span> <span class="toc-text">Tftpd server Settings</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DHCP-Setup"><span class="toc-number">6.6.</span> <span class="toc-text">DHCP Setup</span></a></li></ol></li></ol>
		
		</div>
		
		<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在tftp那篇文章中我提到过一般网络安装基于Linux下PXE+TFTP+DHCP+(HTTP/FTP/NFS)来实现，然而在真实的生产环境中分别测试了Cloudboot和Cobbler，面对大量型号和配置不一样的物理机并不能满足实际需求。最后采用Windows笔记本+交换机+tftpd32+kickstart来灵活应对esxi6和rhel6.7的自动化装机，为了不依赖自动化光盘安装的低效懒人模式，中间还是踩了不少的坑。个人觉得装机并没有孰优孰劣的说法，而且未来是属于分布式存储+万兆交换机+类似VMware/OpenStack的模式，人肉装机的时代已经离我们渐行渐远。</p>
<blockquote>
<p>利用tftpd32快速搭建自动化网络搞机平台</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2017年01月19日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/tftpd32/">https://wsgzao.github.io/post/tftpd32/</a></p>
<p><strong>扩展阅读</strong></p>
<p>Tftd32 - <a href="http://tftpd32.jounin.net/" target="_blank" rel="external">http://tftpd32.jounin.net/</a><br>Kickstart Generator - <a href="https://access.redhat.com/labsinfo/kickstartconfig" target="_blank" rel="external">https://access.redhat.com/labsinfo/kickstartconfig</a></p>
<hr>
<h2 id="3点建议"><a href="#3点建议" class="headerlink" title="3点建议"></a>3点建议</h2><ol>
<li>PXE只是网络安装的引导方式，自动化的核心配置文件始终依赖kickstart/autoyast/autounattend等</li>
<li>文章内提到的引导介质均提取自rhel6.7镜像文件<code>syslinux-nonlinux-4.04-3.el6.noarch.rpm</code></li>
<li>云霁科技的Cloudboot成熟度非常高，建议大家多参考其高质量的配置方案</li>
</ol>
<p>CloudBoot 云启装机平台(开源版) - <a href="http://www.idcos.com/products/cloudboot-open-source" target="_blank" rel="external">http://www.idcos.com/products/cloudboot-open-source</a></p>
<p><img src="https://ooo.0o0.ooo/2017/01/19/588083153cca3.jpg" alt=""><br><img src="https://ooo.0o0.ooo/2017/01/19/5880832627c41.jpg" alt=""><br><img src="https://ooo.0o0.ooo/2017/01/19/5880832f2bd2a.jpg" alt=""></p>
<h2 id="esxi"><a href="#esxi" class="headerlink" title="esxi"></a>esxi</h2><blockquote>
<p>tftpd32+esxi6.0u2+kickstart+hfs</p>
</blockquote>
<ol>
<li>Windows下关闭防火墙，设置IP地址为192.168.1.1/24</li>
<li>启动tftpd32参考上图所示配置，<code>Base Directory</code>目录选择实际定义的路径，如<code>tftpboot_esxi\</code></li>
<li>解压ESXi ISO至<code>tftpboot_esxi\</code>，修改BOOT.CFG添加kernelopt=ks=<a href="http://192.168.1.1/esxi6/KS.CFG" target="_blank" rel="external">http://192.168.1.1/esxi6/KS.CFG</a></li>
<li>将KS.CFG放入自定义目录，使用hfs加载</li>
<li>复制syslinux中的pxelinux.0到<code>tftpboot_esxi\</code></li>
<li>复制syslinux中的MENU.C32<code>替换</code>tftpboot_esxi`中的同名文件</li>
<li>创建<code>tftpboot_esxi\pxelinux.cfg\</code>目录，复制ESXi ISO文件中的ISOLINUX.CFG至该目录并改名为default</li>
<li>检查tftpd32服务启动正常，测试自动化网络安装esxi</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#BOOT.CFG</span></div><div class="line"></div><div class="line">bootstate=0</div><div class="line">title=Loading ESXi installer</div><div class="line">timeout=5</div><div class="line">kernel=/tboot.b00</div><div class="line">kernelopt=ks=http://192.168.1.1/esxi6/KS.CFG</div><div class="line">modules=/b.b00 --- /jumpstrt.gz --- /useropts.gz --- /k.b00 --- /chardevs.b00 --- /a.b00 --- /user.b00 --- /uc_intel.b00 --- /uc_amd.b00 --- /sb.v00 --- /s.v00 --- /scsi_mpt.v00 --- /net_tg3.v00 --- /elxnet.v00 --- /ima_be2i.v00 --- /lpfc.v00 --- /scsi_be2.v00 --- /amsHelpe.v00 --- /conrep.v00 --- /hpbootcf.v00 --- /hpe_buil.v00 --- /hpe_esxi.v00 --- /hpe_ilo.v00 --- /hpe_smx_.v00 --- /hponcfg.v00 --- /hpssacli.v00 --- /hptestev.v00 --- /char_hpc.v00 --- /hpnmi.v00 --- /scsi_hpd.v00 --- /scsi_hps.v00 --- /scsi_hpv.v00 --- /intelcim.v00 --- /net_i40e.v00 --- /net_igb.v00 --- /net_ixgb.v00 --- /nmlx4_co.v00 --- /nmlx4_en.v00 --- /misc_cni.v00 --- /net_bnx2.v00 --- /net_bnx2.v01 --- /net_cnic.v00 --- /net_nx_n.v00 --- /net_qlcn.v00 --- /qlnative.v00 --- /scsi_bfa.v00 --- /scsi_bnx.v00 --- /scsi_bnx.v01 --- /scsi_qla.v00 --- /mtip32xx.v00 --- /ata_pata.v00 --- /ata_pata.v01 --- /ata_pata.v02 --- /ata_pata.v03 --- /ata_pata.v04 --- /ata_pata.v05 --- /ata_pata.v06 --- /ata_pata.v07 --- /block_cc.v00 --- /ehci_ehc.v00 --- /emulex_e.v00 --- /weaselin.t00 --- /esx_dvfi.v00 --- /esx_ui.v00 --- /ima_qla4.v00 --- /ipmi_ipm.v00 --- /ipmi_ipm.v01 --- /ipmi_ipm.v02 --- /lsi_mr3.v00 --- /lsi_msgp.v00 --- /lsu_hp_h.v00 --- /lsu_lsi_.v00 --- /lsu_lsi_.v01 --- /lsu_lsi_.v02 --- /lsu_lsi_.v03 --- /lsu_lsi_.v04 --- /misc_dri.v00 --- /net_e100.v00 --- /net_e100.v01 --- /net_enic.v00 --- /net_forc.v00 --- /net_mlx4.v00 --- /net_mlx4.v01 --- /net_vmxn.v00 --- /nmlx4_rd.v00 --- /nvme.v00 --- /ohci_usb.v00 --- /rste.v00 --- /sata_ahc.v00 --- /sata_ata.v00 --- /sata_sat.v00 --- /sata_sat.v01 --- /sata_sat.v02 --- /sata_sat.v03 --- /sata_sat.v04 --- /scsi_aac.v00 --- /scsi_adp.v00 --- /scsi_aic.v00 --- /scsi_fni.v00 --- /scsi_ips.v00 --- /scsi_meg.v00 --- /scsi_meg.v01 --- /scsi_meg.v02 --- /scsi_mpt.v01 --- /scsi_mpt.v02 --- /uhci_usb.v00 --- /vsan.v00 --- /vsanheal.v00 --- /vsanmgmt.v00 --- /xhci_xhc.v00 --- /tools.t00 --- /nmst.v00 --- /xorg.v00 --- /imgdb.tgz --- /imgpayld.tgz</div><div class="line">build=</div><div class="line">updated=0</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#default</span></div><div class="line"></div><div class="line">DEFAULT menu.c32</div><div class="line">MENU TITLE ESXi6.0u2 Boot Menu</div><div class="line">NOHALT 1</div><div class="line">PROMPT 0</div><div class="line">TIMEOUT 80</div><div class="line">LABEL install</div><div class="line">  KERNEL mboot.c32</div><div class="line">  APPEND -c boot.cfg</div><div class="line">  MENU LABEL ESXi6.0u2 ^Installer</div><div class="line">LABEL hddboot</div><div class="line">  LOCALBOOT 0x80</div><div class="line">  MENU LABEL ^Boot from <span class="built_in">local</span> disk</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#KS.CFG</span></div><div class="line"></div><div class="line"><span class="comment"># Accept the VMware End User License Agreement</span></div><div class="line">vmaccepteula</div><div class="line"></div><div class="line"><span class="comment"># Set the root password for the DCUI and Tech Support Mode</span></div><div class="line">rootpw admin123</div><div class="line"><span class="comment"># Install on the first local disk available on machine</span></div><div class="line">install --firstdisk --overwritevmfs</div><div class="line"></div><div class="line"><span class="comment"># Set the network to DHCP on the first network adapter</span></div><div class="line">network --bootproto=dhcp --device=vmnic0</div><div class="line"></div><div class="line"><span class="comment"># Reboot at the end</span></div><div class="line">reboot</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div></pre></td><td class="code"><pre><div class="line">file://H:\01_autoinstall\tftpboot_esxi  (3 folders, 129 files, 377.76 MB, 379.93 MB <span class="keyword">in</span> total.)</div><div class="line">│  .DISCINFO 33 bytes</div><div class="line">│  A.B00 10.96 KB</div><div class="line">│  AMSHELPE.V00  1.32 MB</div><div class="line">│  ATA_PATA.V00  8.28 KB</div><div class="line">│  ATA_PATA.V01  6.22 KB</div><div class="line">│  ATA_PATA.V02  6.47 KB</div><div class="line">│  ATA_PATA.V03  7.22 KB</div><div class="line">│  ATA_PATA.V04  8.33 KB</div><div class="line">│  ATA_PATA.V05  7.01 KB</div><div class="line">│  ATA_PATA.V06  6.17 KB</div><div class="line">│  ATA_PATA.V07  7.59 KB</div><div class="line">│  B.B00 75.03 KB</div><div class="line">│  BLOCK_CC.V00  23.75 KB</div><div class="line">│  BOOT.CAT  512 bytes</div><div class="line">│  BOOT.CFG  2.07 KB</div><div class="line">│  CHAR_HPC.V00  9.93 KB</div><div class="line">│  CHARDEVS.B00  18.67 KB</div><div class="line">│  CONREP.V00    1.87 MB</div><div class="line">│  EFIBOOT.IMG   1.00 MB</div><div class="line">│  EHCI_EHC.V00  32.99 KB</div><div class="line">│  ELXNET.V00    132.88 KB</div><div class="line">│  EMULEX_E.V00  5.68 KB</div><div class="line">│  ESX_DVFI.V00  89.19 KB</div><div class="line">│  ESX_UI.V00    2.83 MB</div><div class="line">│  HPBOOTCF.V00  28.52 KB</div><div class="line">│  HPE_BUIL.V00  458 bytes</div><div class="line">│  HPE_ESXI.V00  1.51 MB</div><div class="line">│  HPE_ILO.V00   9.50 KB</div><div class="line">│  HPE_SMX_.V00  7.81 MB</div><div class="line">│  HPNMI.V00 4.20 KB</div><div class="line">│  HPONCFG.V00   96.62 KB</div><div class="line">│  HPSSACLI.V00  4.97 MB</div><div class="line">│  HPTESTEV.V00  6.29 KB</div><div class="line">│  IMA_BE2I.V00  489.49 KB</div><div class="line">│  IMA_QLA4.V00  359.39 KB</div><div class="line">│  IMGDB.TGZ 62.35 KB</div><div class="line">│  IMGPAYLD.TGZ  3.94 MB</div><div class="line">│  INTELCIM.V00  94.06 KB</div><div class="line">│  IPMI_IPM.V00  9.38 KB</div><div class="line">│  IPMI_IPM.V01  22.99 KB</div><div class="line">│  IPMI_IPM.V02  27.91 KB</div><div class="line">│  ISOLINUX.BIN  14.00 KB</div><div class="line">│  ISOLINUX.CFG  231 bytes</div><div class="line">│  JUMPSTRT.GZ   20 bytes</div><div class="line">│  K.B00 3.26 MB</div><div class="line">│  KS.CFG    356 bytes</div><div class="line">│  LPFC.V00  555.77 KB</div><div class="line">│  LSI_MR3.V00   68.98 KB</div><div class="line">│  LSI_MSGP.V00  117.96 KB</div><div class="line">│  LSU_HP_H.V00  15.34 KB</div><div class="line">│  LSU_LSI_.V00  78.96 KB</div><div class="line">│  LSU_LSI_.V01  159.84 KB</div><div class="line">│  LSU_LSI_.V02  78.96 KB</div><div class="line">│  LSU_LSI_.V03  187.32 KB</div><div class="line">│  LSU_LSI_.V04  114.35 KB</div><div class="line">│  MBOOT.C32 84.17 KB</div><div class="line">│  MENU.C32  60.35 KB</div><div class="line">│  MISC_CNI.V00  5.51 KB</div><div class="line">│  MISC_DRI.V00  1.24 MB</div><div class="line">│  MTIP32XX.V00  67.84 KB</div><div class="line">│  NET_BNX2.V00  178.17 KB</div><div class="line">│  NET_BNX2.V01  1.00 MB</div><div class="line">│  NET_CNIC.V00  48.42 KB</div><div class="line">│  NET_E100.V00  93.66 KB</div><div class="line">│  NET_E100.V01  108.27 KB</div><div class="line">│  NET_ENIC.V00  43.63 KB</div><div class="line">│  NET_FORC.V00  36.61 KB</div><div class="line">│  NET_I40E.V00  132.01 KB</div><div class="line">│  NET_IGB.V00   101.62 KB</div><div class="line">│  NET_IXGB.V00  167.56 KB</div><div class="line">│  NET_MLX4.V00  107.78 KB</div><div class="line">│  NET_MLX4.V01  66.30 KB</div><div class="line">│  NET_NX_N.V00  1.32 MB</div><div class="line">│  NET_QLCN.V00  283.02 KB</div><div class="line">│  NET_TG3.V00   107.81 KB</div><div class="line">│  NET_VMXN.V00  30.50 KB</div><div class="line">│  NMLX4_CO.V00  117.53 KB</div><div class="line">│  NMLX4_EN.V00  119.73 KB</div><div class="line">│  NMLX4_RD.V00  39.92 KB</div><div class="line">│  NMST.V00  12.32 KB</div><div class="line">│  NVME.V00  63.07 KB</div><div class="line">│  OHCI_USB.V00  19.44 KB</div><div class="line">│  pxelinux.0    26.13 KB</div><div class="line">│  QLNATIVE.V00  731.51 KB</div><div class="line">│  RSTE.V00  209.06 KB</div><div class="line">│  S.V00 92.98 MB</div><div class="line">│  SAFEBOOT.C32  61.79 KB</div><div class="line">│  SATA_AHC.V00  19.80 KB</div><div class="line">│  SATA_ATA.V00  11.79 KB</div><div class="line">│  SATA_SAT.V00  17.16 KB</div><div class="line">│  SATA_SAT.V01  10.32 KB</div><div class="line">│  SATA_SAT.V02  10.86 KB</div><div class="line">│  SATA_SAT.V03  8.03 KB</div><div class="line">│  SATA_SAT.V04  6.35 KB</div><div class="line">│  SB.V00    48.31 MB</div><div class="line">│  SCSI_AAC.V00  52.10 KB</div><div class="line">│  SCSI_ADP.V00  143.31 KB</div><div class="line">│  SCSI_AIC.V00  95.67 KB</div><div class="line">│  SCSI_BE2.V00  247.25 KB</div><div class="line">│  SCSI_BFA.V00  1.20 MB</div><div class="line">│  SCSI_BNX.V00  95.69 KB</div><div class="line">│  SCSI_BNX.V01  78.25 KB</div><div class="line">│  SCSI_FNI.V00  64.13 KB</div><div class="line">│  SCSI_HPD.V00  937.40 KB</div><div class="line">│  SCSI_HPS.V00  72.92 KB</div><div class="line">│  SCSI_HPV.V00  704.64 KB</div><div class="line">│  SCSI_IPS.V00  32.12 KB</div><div class="line">│  SCSI_MEG.V00  28.29 KB</div><div class="line">│  SCSI_MEG.V01  54.13 KB</div><div class="line">│  SCSI_MEG.V02  26.45 KB</div><div class="line">│  SCSI_MPT.V00  132.34 KB</div><div class="line">│  SCSI_MPT.V01  147.33 KB</div><div class="line">│  SCSI_MPT.V02  124.50 KB</div><div class="line">│  SCSI_QLA.V00  147.12 KB</div><div class="line">│  TBOOT.B00 43.32 KB</div><div class="line">│  TOOLS.T00 180.67 MB</div><div class="line">│  UC_AMD.B00    3.41 KB</div><div class="line">│  UC_INTEL.B00  135.83 KB</div><div class="line">│  UHCI_USB.V00  19.82 KB</div><div class="line">│  USER.B00  447.52 KB</div><div class="line">│  USEROPTS.GZ   20 bytes</div><div class="line">│  VMWARE-ESX-BASE-OSL.TXT   1.13 MB</div><div class="line">│  VMWARE-ESX-BASE-README    2.19 KB</div><div class="line">│  VSAN.V00  6.73 MB</div><div class="line">│  VSANHEAL.V00  168.57 KB</div><div class="line">│  VSANMGMT.V00  1.35 MB</div><div class="line">│  WEASELIN.T00  1.93 MB</div><div class="line">│  XHCI_XHC.V00  72.94 KB</div><div class="line">│  XORG.V00  1.28 MB</div><div class="line">├─EFI   (1 folders, 0 files, 0 bytes, 193.17 KB <span class="keyword">in</span> total.)</div><div class="line">│  └─BOOT    (0 folders, 3 files, 193.17 KB, 193.17 KB <span class="keyword">in</span> total.)</div><div class="line">│          BOOT.CFG  2.04 KB</div><div class="line">│          BOOTIA32.EFI  94.59 KB</div><div class="line">│          BOOTX64.EFI   96.53 KB</div><div class="line">├─pxelinux.cfg  (0 folders, 1 files, 231 bytes, 231 bytes <span class="keyword">in</span> total.)</div><div class="line">│      default 231 bytes</div><div class="line">└─UPGRADE   (0 folders, 10 files, 1.98 MB, 1.98 MB <span class="keyword">in</span> total.)</div><div class="line">        ESXIMAGE.ZIP    874.17 KB</div><div class="line">        EXTLINUX    62.51 KB</div><div class="line">        ISOINFO 233.62 KB</div><div class="line">        MBR.BIN 440 bytes</div><div class="line">        MCOPY   584.17 KB</div><div class="line">        METADATA.XML    1.54 KB</div><div class="line">        METADATA.ZIP    141.08 KB</div><div class="line">        PRECHECK.PY 72.78 KB</div><div class="line">        PREP.PY 47.54 KB</div><div class="line">        PROFILE.XML 8.85 KB</div></pre></td></tr></table></figure>
<blockquote>
<p>引用他人在Linux下的安装流程</p>
</blockquote>
<p>PEX安装ESXi6 - <a href="http://blog.csdn.net/onlyshenmin/article/details/52434743" target="_blank" rel="external">http://blog.csdn.net/onlyshenmin/article/details/52434743</a> </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#安装dhcp、tftp-server、syslinux、xinetd。</span></div><div class="line">yum install dhcp tftp-server syslinux xinetd</div><div class="line"></div><div class="line"><span class="comment">#挂载ESXi ISO到/mnt</span></div><div class="line">mount /dev/cdrom /mnt</div><div class="line"></div><div class="line"><span class="comment">#修改dhcpd.conf</span></div><div class="line">ddns-update-style interim;</div><div class="line">allow booting;</div><div class="line">allow bootp;</div><div class="line">class <span class="string">"pxeclients"</span> &#123;</div><div class="line">    match <span class="keyword">if</span> substring(option vendor-class-identifier, 0, 9) = <span class="string">"PXEClient"</span>;</div><div class="line">    next-server 172.16.8.7;</div><div class="line">    filename = <span class="string">"pxelinux.0"</span>;</div><div class="line">&#125;</div><div class="line">subnet 172.16.8.0 netmask 255.255.255.0 &#123;</div><div class="line">    range 172.16.8.100 172.16.8.199;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">#启用tftp,修改/etc/xinetd.d/tftp中的disable = yes为disable = no</span></div><div class="line">service tftp</div><div class="line">&#123;</div><div class="line">        socket_type             = dgram</div><div class="line">        protocol                = udp</div><div class="line">        <span class="built_in">wait</span>                    = yes</div><div class="line">        user                    = root</div><div class="line">        server                  = /usr/sbin/in.tftpd</div><div class="line">        server_args             = -s /var/lib/tftpboot</div><div class="line">        <span class="built_in">disable</span>                 = no</div><div class="line">        per_source              = 11</div><div class="line">        cps                     = 100 2</div><div class="line">        flags                   = IPv4</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">#复制pxelinux.0到tftp根目录</span></div><div class="line">cp /usr/share/syslinux/pxelinux.0 /var/lib/tftpboot/</div><div class="line"></div><div class="line"><span class="comment">#新建目录/var/lib/tftpboot/pxelinux.cfg</span></div><div class="line">mkdir /var/lib/tftpboot/pxelinux.cfg</div><div class="line"></div><div class="line"><span class="comment">#复制ESXi ISO文件中的isolinux.cfg到/var/lib/tftpboot/pxelinux.cfg/下并改名default</span></div><div class="line">cp /mnt/isolinux.cfg /var/lib/tftpboot/pxelinux.cfg/default</div><div class="line"></div><div class="line"><span class="comment">#复制ESXi ISO中的全部文件到/var/lib/tftpboot/下</span></div><div class="line">cp -a  /mnt/* /var/lib/tftpboot/</div><div class="line"></div><div class="line"><span class="comment">#复制syslinux自带的menu.c32到tftp根目录替换掉ESXI ISO里的menu.c32。</span></div><div class="line">cp /usr/share/syslinux/menu.c32  /var/lib/tftpboot/</div><div class="line"></div><div class="line"><span class="comment">#重启dhcp、xinetd服务</span></div><div class="line">systemctl restart dhcpd</div><div class="line">systemctl restart xinetd</div><div class="line"></div><div class="line"><span class="comment">#自定义安装脚本，安装httpd，编辑脚本ks.cfg</span></div><div class="line">vim /var/www/html/ks.cfg</div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># Sample scripted installation file</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># Accept the VMware End User License Agreement</span></div><div class="line">vmaccepteula</div><div class="line"><span class="comment"># Set the root password for the DCUI and Tech Support Mode</span></div><div class="line">rootpw mypassword</div><div class="line"><span class="comment"># Install on the first local disk available on machine</span></div><div class="line">install --firstdisk --overwritevmfs</div><div class="line"><span class="comment"># Set the network to DHCP on the first network adapter</span></div><div class="line">network --bootproto=dhcp --device=vmnic0</div><div class="line"><span class="comment"># A sample post-install script</span></div><div class="line">%post --interpreter=python --ignorefailure=<span class="literal">true</span></div><div class="line">import time</div><div class="line">stampFile = open(<span class="string">'/finished.stamp'</span>, mode=<span class="string">'w'</span>)</div><div class="line">stampFile.write( time.asctime() )</div><div class="line"></div><div class="line"><span class="comment">#编辑ESXi ISO复制过来的boot.cfg文件，添加kernelopt=ks=http://172.16.8.7/ks.cfg</span></div><div class="line">vim /var/lib/tftpboot/boot.cfg</div><div class="line"></div><div class="line">bootstate=0</div><div class="line">title=Loading ESXi installer</div><div class="line">timeout=5</div><div class="line">kernel=/tboot.b00</div><div class="line">kernelopt=ks=http://172.16.8.7/ks.cfg</div><div class="line">modules=/b.b00 --- /jumpstrt.gz --- /useropts.gz --- /k.b00 --- /chardevs.b00 --- /a.b00 --- /user.b00 --- /uc_intel.b00 --- /uc_amd.b00 --- /sb.v00 --- /s.v00 --- /mtip32xx.v00 --- /ata_pata.v00 --- /ata_pata.v01 --- /ata_pata.v02 --- /ata_pata.v03 --- /ata_pata.v04 --- /ata_pata.v05 --- /ata_pata.v06 --- /ata_pata.v07 --- /block_cc.v00 --- /ehci_ehc.v00 --- /elxnet.v00 --- /emulex_e.v00 --- /weaselin.t00 --- /esx_dvfi.v00 --- /esx_ui.v00 --- /ima_qla4.v00 --- /ipmi_ipm.v00 --- /ipmi_ipm.v01 --- /ipmi_ipm.v02 --- /lpfc.v00 --- /lsi_mr3.v00 --- /lsi_msgp.v00 --- /lsu_hp_h.v00 --- /lsu_lsi_.v00 --- /lsu_lsi_.v01 --- /lsu_lsi_.v02 --- /lsu_lsi_.v03 --- /lsu_lsi_.v04 --- /misc_cni.v00 --- /misc_dri.v00 --- /net_bnx2.v00 --- /net_bnx2.v01 --- /net_cnic.v00 --- /net_e100.v00 --- /net_e100.v01 --- /net_enic.v00 --- /net_forc.v00 --- /net_igb.v00 --- /net_ixgb.v00 --- /net_mlx4.v00 --- /net_mlx4.v01 --- /net_nx_n.v00 --- /net_tg3.v00 --- /net_vmxn.v00 --- /nmlx4_co.v00 --- /nmlx4_en.v00 --- /nmlx4_rd.v00 --- /nvme.v00 --- /ohci_usb.v00 --- /qlnative.v00 --- /rste.v00 --- /sata_ahc.v00 --- /sata_ata.v00 --- /sata_sat.v00 --- /sata_sat.v01 --- /sata_sat.v02 --- /sata_sat.v03 --- /sata_sat.v04 --- /scsi_aac.v00 --- /scsi_adp.v00 --- /scsi_aic.v00 --- /scsi_bnx.v00 --- /scsi_bnx.v01 --- /scsi_fni.v00 --- /scsi_hps.v00 --- /scsi_ips.v00 --- /scsi_meg.v00 --- /scsi_meg.v01 --- /scsi_meg.v02 --- /scsi_mpt.v00 --- /scsi_mpt.v01 --- /scsi_mpt.v02 --- /scsi_qla.v00 --- /uhci_usb.v00 --- /vsan.v00 --- /vsanheal.v00 --- /vsanmgmt.v00 --- /xhci_xhc.v00 --- /tools.t00 --- /xorg.v00 --- /imgdb.tgz --- /imgpayld.tgz</div><div class="line">build=</div><div class="line">updated=0</div></pre></td></tr></table></figure>
<h2 id="rhel"><a href="#rhel" class="headerlink" title="rhel"></a>rhel</h2><blockquote>
<p>tftpd32+rhel6.7+kickstart+hfs</p>
</blockquote>
<ol>
<li>Windows下关闭防火墙，设置IP地址为192.168.1.1/24</li>
<li>启动tftpd32参考上图所示配置，<code>Base Directory</code>目录选择实际定义的路径，如<code>tftpboot_rhel\</code></li>
<li>解压rhel6.7 ISO至自定义目录，使用hfs作为http文件服务器</li>
<li>将ks.cfg放入自定义目录，使用hfs加载</li>
<li>复制syslinux中的<code>pxelinux.0/initrd.img/vesamenu.c32/vmlinuz</code>到<code>tftpboot_rhel\</code></li>
<li>创建pxelinux.cfg目录，复制rhel6.7 ISO文件中的ISOLINUX.CFG至该目录并改名为default</li>
<li>修改default文件，ks=<a href="http://192.168.1.1/rhel67/ks.cfg" target="_blank" rel="external">http://192.168.1.1/rhel67/ks.cfg</a> ksdevice=eth10，出现<code>multiple network devices</code>提示一定要加入ksdevice确认网卡</li>
<li>检查tftpd32服务启动正常，测试自动化网络安装rhel</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#default</span></div><div class="line"></div><div class="line">default vesamenu.c32</div><div class="line"><span class="comment">#prompt 1</span></div><div class="line">timeout 60</div><div class="line"></div><div class="line">display boot.msg</div><div class="line"></div><div class="line">menu background splash.jpg</div><div class="line">menu title Welcome to Red Hat Enterprise Linux 6.7!</div><div class="line">menu color border 0 <span class="comment">#ffffffff #00000000</span></div><div class="line">menu color sel 7 <span class="comment">#ffffffff #ff000000</span></div><div class="line">menu color title 0 <span class="comment">#ffffffff #00000000</span></div><div class="line">menu color tabmsg 0 <span class="comment">#ffffffff #00000000</span></div><div class="line">menu color unsel 0 <span class="comment">#ffffffff #00000000</span></div><div class="line">menu color hotsel 0 <span class="comment">#ff000000 #ffffffff</span></div><div class="line">menu color hotkey 7 <span class="comment">#ffffffff #ff000000</span></div><div class="line">menu color scrollbar 0 <span class="comment">#ffffffff #00000000</span></div><div class="line"></div><div class="line">label linux</div><div class="line">  menu label ^Install or upgrade an existing system</div><div class="line">  menu default</div><div class="line">  kernel vmlinuz</div><div class="line">  append initrd=initrd.img ks=http://192.168.1.1/rhel67/ks.cfg ksdevice=eth10</div><div class="line">label vesa</div><div class="line">  menu label Install system with ^basic video driver</div><div class="line">  kernel vmlinuz</div><div class="line">  append initrd=initrd.img nomodeset</div><div class="line">label rescue</div><div class="line">  menu label ^Rescue installed system</div><div class="line">  kernel vmlinuz</div><div class="line">  append initrd=initrd.img rescue</div><div class="line">label <span class="built_in">local</span></div><div class="line">  menu label Boot from ^<span class="built_in">local</span> drive</div><div class="line">  localboot 0xffff</div><div class="line">label memtest86</div><div class="line">  menu label ^Memory <span class="built_in">test</span></div><div class="line">  kernel memtest</div><div class="line">  append -</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#ks.cfg</span></div><div class="line"></div><div class="line"><span class="comment">#platform=x86, AMD64, or Intel EM64T</span></div><div class="line"><span class="comment">#version=DEVEL</span></div><div class="line"><span class="comment"># Firewall configuration</span></div><div class="line">firewall --disabled</div><div class="line"><span class="comment"># Install OS instead of upgrade</span></div><div class="line">install</div><div class="line"><span class="comment">#cdrom</span></div><div class="line">url --url=http://192.168.1.1/rhel67/</div><div class="line"><span class="comment"># Network</span></div><div class="line"><span class="comment">#network --bootproto=dhcp --device=eth0</span></div><div class="line"><span class="comment"># Root password</span></div><div class="line">rootpw admin123</div><div class="line"><span class="comment"># System authorization information</span></div><div class="line">auth  --useshadow  --passalgo=sha512</div><div class="line"><span class="comment"># Use text mode install</span></div><div class="line">text</div><div class="line">firstboot --<span class="built_in">disable</span></div><div class="line"><span class="comment"># System keyboard</span></div><div class="line">keyboard us</div><div class="line"><span class="comment"># System language</span></div><div class="line">lang en_US.UTF-8</div><div class="line"><span class="comment"># SELinux configuration</span></div><div class="line">selinux --disabled</div><div class="line"><span class="comment"># Installation logging level</span></div><div class="line">logging --level=info</div><div class="line"><span class="comment"># Reboot after installation</span></div><div class="line">reboot</div><div class="line"><span class="comment"># System timezone</span></div><div class="line">timezone Asia/Shanghai</div><div class="line"><span class="comment"># System bootloader configuration</span></div><div class="line">bootloader --location=mbr --append=<span class="string">"rhgb quiet crashkernel=auto"</span></div><div class="line"><span class="comment"># Clear the Master Boot Record</span></div><div class="line">zerombr</div><div class="line"><span class="comment"># Partition clearing information</span></div><div class="line">clearpart --all --initlabel</div><div class="line"><span class="comment"># Partition</span></div><div class="line"><span class="comment">#autopart</span></div><div class="line">part /boot --fstype=ext4 --size=500</div><div class="line">part pv.008002 --grow --size=1</div><div class="line">volgroup VolGroup --pesize=4096 pv.008002</div><div class="line">logvol / --fstype=ext4 --name=lv_root --vgname=VolGroup --size=20480</div><div class="line">logvol /home --fstype=ext4 --name=lv_home --vgname=VolGroup --size=20480</div><div class="line">logvol /opt --fstype=ext4 --name=lv_opt --vgname=VolGroup --size=20480</div><div class="line">logvol /tmp --fstype=ext4 --name=lv_tmp --vgname=VolGroup --size=20480</div><div class="line">logvol /usr --fstype=ext4 --name=lv_usr --vgname=VolGroup --size=20480</div><div class="line">logvol /var --fstype=ext4 --name=lv_var --vgname=VolGroup --size=20480</div><div class="line">logvol swap --name=lv_swap --vgname=VolGroup --size=65536</div><div class="line"><span class="comment"># Packages</span></div><div class="line">%packages</div><div class="line">@base</div><div class="line">@chinese-support</div><div class="line">@client-mgmt-tools</div><div class="line">@core</div><div class="line">@debugging</div><div class="line">@basic-desktop</div><div class="line">@desktop-debugging</div><div class="line">@desktop-platform</div><div class="line">@directory-client</div><div class="line">@fonts</div><div class="line">@general-desktop</div><div class="line">@graphical-admin-tools</div><div class="line">@input-methods</div><div class="line">@internet-browser</div><div class="line">@java-platform</div><div class="line">@legacy-x</div><div class="line">@network-file-system-client</div><div class="line">@perl-runtime</div><div class="line">@<span class="built_in">print</span>-client</div><div class="line">@remote-desktop-clients</div><div class="line">@server-platform</div><div class="line">@server-policy</div><div class="line">@x11</div><div class="line">pax</div><div class="line">python-dmidecode</div><div class="line">oddjob</div><div class="line">wodim</div><div class="line">sgpio</div><div class="line">genisoimage</div><div class="line">mtools</div><div class="line">abrt-gui</div><div class="line">certmonger</div><div class="line">pam_krb5</div><div class="line">krb5-workstation</div><div class="line">libXmu</div><div class="line">perl-DBD-SQLite</div><div class="line">%end</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">file://H:\01_autoinstall\tftpboot_rhel  (1 folders, 4 files, 38.93 MB, 38.93 MB <span class="keyword">in</span> total.)</div><div class="line">│  initrd.img    34.72 MB</div><div class="line">│  pxelinux.0    26.13 KB</div><div class="line">│  vesamenu.c32  159.89 KB</div><div class="line">│  vmlinuz   4.03 MB</div><div class="line">└─pxelinux.cfg  (0 folders, 1 files, 991 bytes, 991 bytes <span class="keyword">in</span> total.)</div><div class="line">        default 991 bytes</div></pre></td></tr></table></figure>
<blockquote>
<p>引用他人在Linux下的安装流程</p>
</blockquote>
<p>RHEL6 (64bits)系统上利用PXE+DHCP+TFTP+KickStart批量安装系统<br><a href="http://chrinux.blog.51cto.com/6466723/1214641" target="_blank" rel="external">http://chrinux.blog.51cto.com/6466723/1214641</a></p>
<p>CentOS 6.4下PXE+Kickstart无人值守安装操作系统<br><a href="http://www.cnblogs.com/mchina/p/centos-pxe-kickstart-auto-install-os.html" target="_blank" rel="external">http://www.cnblogs.com/mchina/p/centos-pxe-kickstart-auto-install-os.html</a></p>
<h2 id="tftpd32"><a href="#tftpd32" class="headerlink" title="tftpd32"></a>tftpd32</h2><blockquote>
<p>请允许我直接偷懒引用官方简洁纯朴的英文说明，希望大家在遇到问题前回顾下每个选项的解释，谢谢</p>
</blockquote>
<p>Tftpd32 is a free, opensource IPv6 ready application which includes DHCP, TFTP, DNS, SNTP and Syslog servers as well as a TFTP client.</p>
<h3 id="TFTP"><a href="#TFTP" class="headerlink" title="TFTP"></a>TFTP</h3><p>Trivial File Transfer Protocol was first defined in 1980, it is a lightweight version of the FTP protocol that has no directory browsing or password capability. Employing UDP rather than TCP for transport, TFTP is typically used to transfer firmware upgrades to network equipment such as routers, switches and IP phones.It is also used to boot diskless computers (PXE). </p>
<h3 id="SNTP"><a href="#SNTP" class="headerlink" title="SNTP"></a>SNTP</h3><p>Simple Network Timle Protocol is a simplified version of NTP (Network Time Protocol). They synchronise the time on workstations across a network. </p>
<h3 id="DHCP"><a href="#DHCP" class="headerlink" title="DHCP"></a>DHCP</h3><p>DHCP assigns IP addresses to client stations logging onto a TCP/IP network. It eliminates having to manually assign permanent IP addresses on each station. </p>
<h3 id="Syslog"><a href="#Syslog" class="headerlink" title="Syslog"></a>Syslog</h3><p>Syslog is a service for remotely logging data. For example, it allows to monitor videoless network equipments. </p>
<h3 id="Tftpd-server-Settings"><a href="#Tftpd-server-Settings" class="headerlink" title="Tftpd server Settings"></a>Tftpd server Settings</h3><p><strong>Base directory</strong><br>The default directory used by the TFTP client and server. It may be changed from the main window.</p>
<p><strong>Global Settings</strong><br>Enable or disable tftpd32 servers and clients.</p>
<p><strong>TFTP security</strong></p>
<ul>
<li>NONE   (Not recommended !)<br>read and write requests are allowed on all disks/directories. </li>
<li>Standard<br>read and write requests are allowed but limited to the current directory. </li>
<li>High<br>idem standard + write requests are allowed only if the input file exists and is empty. </li>
<li>Read only<br>idem standard + write requests are rejected. </li>
</ul>
<p><strong>TFTP Configuration</strong></p>
<ul>
<li>Timeout<br>The maximum timeout between two retransmissions </li>
<li>Max Retransmit<br>The maximum retransmission for the same packet </li>
<li>Tftp Port<br>The port used to listen incoming requests </li>
<li>local ports pool<br>A range of ports (for example 3000:3030). These ports are used for the file transfers. </li>
</ul>
<p><strong>TFTP Configuration</strong></p>
<ul>
<li>Option Negotiation<br>Enables the negotiation between client and server (RFC 2347) </li>
<li>PXE compatibility<br>Enables only the file size negotiation </li>
<li>Show progress Bar<br>Creates a gauge window for each transfer </li>
<li>Translate Unix file names<br>Translates any slash characters to a backslash </li>
<li>Bind Tftpd32 to this address<br>Enables TFTP only on one interface </li>
<li>Allow ‘\’ As virtual root<br>A file name beginning with ‘\’ points to the TFTP directory and not to the root of the disk </li>
<li>Use anticipation window of ??? bytes<br>Tftpd32 is able to send packets before receiving acknowledgements. This feature may dramatically speed up the transfer. </li>
<li>Hide window at startup<br>Tftpd32 main window remains hidden, but the icon in the tasktray is still present </li>
<li>Create dir.txt files<br>For each incoming read request, Tftpd32 lists the content of the directory and put the result in a file named “dir.txt”. </li>
<li>Create md5 file<br>For each successfull read request, Tftpd32 creates a file which is the MD5 signature of the previous file<br>Beep for long transfer<br>Tftpd32 sends a beep once a transfer has ended.    </li>
</ul>
<h3 id="DHCP-Setup"><a href="#DHCP-Setup" class="headerlink" title="DHCP Setup"></a>DHCP Setup</h3><ul>
<li>IP Pool starting Address<br>This is the first address which will be distributed. </li>
<li>Size of pool<br>This is the number of hosts which may be configured by Tftpd32. </li>
<li>Lease<br>This is the amount of time in minutes the address is leased for. </li>
<li>Boot File<br>Used by diskless stations. It is the file which will be retrieved by TFTP to start up the boot process.<br>The strings $MAC$ and $IP$ are pseudo variables which are translated into the MAC address of the client and its assignated IP address. </li>
<li>Default router<br>The IP address of the LAN gateway. </li>
<li>Mask<br>The network mask which will be assigned to the DHCP clients. </li>
<li>DNS servers<br>The IP address of the DNS. Two DNS can be configured. </li>
<li>WINS Server<br>The IP address of the WINS server. </li>
<li>NTP Server<br>The IP address of the NTP server used for synchronisation. </li>
<li>SIP Server<br>The IP address of the SIP server. It concerns mostly IP phones. </li>
<li>Domain Name<br>Either the NT domain or the internet domain. </li>
<li>Additional Option<br>The first field is the number of the option to be handled<br>The second filed is the value of the field. The value is prefixed with its type (a for list of IPv4 address, x for list of hex digits, b for list of decimal bytes, s for an ASCII string) [legacy prefixes: i for integer, n for network order integers] </li>
<li>More Additional Options ?<br>Tftpd32 supports up to 10 additionnal options. They have to be configured by editing the tftpd32.ini settings file. Their syntax is similar to the previous one. </li>
</ul>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习-Study/">学习 | Study</a>
</div>


</div>



	<div class="article-share" id="share">
	
	  <div data-url="https://wsgzao.github.io/post/tftpd32/" data-title="使用tftpd32自动化网络安装esxi6.0u2和rhel6.7实践 | HelloDog" data-tsina="" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/post/infoscale/" title="Veritas InfoScale Enterprise 7 安装部署手册">
  <strong>上一篇：</strong><br/>
  <span>
  Veritas InfoScale Enterprise 7 安装部署手册</span>
</a>
</div>


<div class="next">
<a href="/post/tftp/"  title="tftp安装和使用小结">
 <strong>下一篇：</strong><br/> 
 <span>tftp安装和使用小结
</span>
</a>
</div>

</nav>

	

<section id="comments" class="comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更新历史"><span class="toc-number">2.</span> <span class="toc-text">更新历史</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3点建议"><span class="toc-number">3.</span> <span class="toc-text">3点建议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#esxi"><span class="toc-number">4.</span> <span class="toc-text">esxi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rhel"><span class="toc-number">5.</span> <span class="toc-text">rhel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tftpd32"><span class="toc-number">6.</span> <span class="toc-text">tftpd32</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TFTP"><span class="toc-number">6.1.</span> <span class="toc-text">TFTP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SNTP"><span class="toc-number">6.2.</span> <span class="toc-text">SNTP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DHCP"><span class="toc-number">6.3.</span> <span class="toc-text">DHCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Syslog"><span class="toc-number">6.4.</span> <span class="toc-text">Syslog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tftpd-server-Settings"><span class="toc-number">6.5.</span> <span class="toc-text">Tftpd server Settings</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DHCP-Setup"><span class="toc-number">6.6.</span> <span class="toc-text">DHCP Setup</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="wsgzao" data-theme="medium"></div>
<script type="text/javascript" src="//lab.lepture.com/github-cards/widget.js" ></script>
</div>



  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/Hexo/" title="Hexo">Hexo<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/学习-Study/" title="学习 | Study">学习 | Study<sup>64</sup></a></li>
		  
		
		  
			<li><a href="/categories/生活-Life/" title="生活 | Life">生活 | Life<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/软件-Soft/" title="软件 | Soft">软件 | Soft<sup>5</sup></a></li>
		  
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.linkedin.com/in/aowang" target="_blank" title="LinkedIn">LinkedIn</a>
            
          </li>
        
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello, I&#39;m OX. This is my blog on GitHub. <br/>
			Keep Calm and Carry On.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/wsgzao" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		<a href="https://www.linkedin.com/in/aowang" target="_blank" class="icon-linkedin" title="linkedin"></a>
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="wsgzao">wsgzao</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
        getSize();
        if (myWidth >= 1024) {
          c.click();
        }
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>




<script type="text/javascript">

var disqus_shortname = 'wsgzao';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>







  <script>
    var xlm_wid='12835';
    var xlm_url='https://www.xianliao.me/';
  </script>
  <script type='text/javascript' charset='UTF-8' src='https://www.xianliao.me/embed.js'></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-77732745-1', 'wsgzao.github.io');  
ga('send', 'pageview');
</script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?c2c5fc7d844d0973d9f77abd87f49c3c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- swiftype Begin -->

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','_4qDmKrBPn9Es3UvQHT4','2.0.0');
</script>

<!-- swiftype End -->

  </body>
</html>
