
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <script type="text/javascript">
    var host = "wsgzao.github.io";
    if ((host == window.location.host) && (window.location.protocol != "https:"))
        window.location.protocol = "https";
  </script> 
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LJ3PMGPVCK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LJ3PMGPVCK');
</script>
  
    <title>在浏览器输入URL回车之后发生了什么 | HelloDog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="wsgzao">
    

    
    <meta name="description" content="在浏览器输入URL回车之后发生了什么">
<meta property="og:type" content="article">
<meta property="og:title" content="在浏览器输入URL回车之后发生了什么">
<meta property="og:url" content="https://wsgzao.github.io/post/url/index.html">
<meta property="og:site_name" content="HelloDog">
<meta property="og:description" content="在浏览器输入URL回车之后发生了什么">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150329.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150347.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150404.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150420.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150439.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150457.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150513.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150529.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150545.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150601.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150616.png">
<meta property="article:published_time" content="2019-10-16T05:34:32.000Z">
<meta property="article:modified_time" content="2023-02-27T05:33:07.163Z">
<meta property="article:author" content="wsgzao">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150329.png">

    
    <link rel="alternative" href="/atom.xml" title="HelloDog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="HelloDog" title="HelloDog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="HelloDog">HelloDog</a></h1>
				<h2 class="blog-motto">Keep Calm and Carry On</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页 | Home</a></li>
					
						<li><a href="/index/">索引 | Index</a></li>
					
						<li><a href="/archives/">归档 | Archives</a></li>
					
						<li><a href="/about/">简介 | About</a></li>
					
					<li>
 					
						<form class="search">
							<label>Search</label>
						<input type="text" id="search" class="st-default-search-input" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/post/url/" title="在浏览器输入URL回车之后发生了什么" itemprop="url">在浏览器输入URL回车之后发生了什么</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="wsgzao" target="_blank" itemprop="author">wsgzao</a>
		
  <p class="article-time">
    <time datetime="2019-10-16T05:34:32.000Z" itemprop="datePublished"> 发表于 2019-10-16</time>
    
  </p>
</header>
	<div class="article-content">
<!-- 		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%8E%86%E5%8F%B2"><span class="toc-number">2.</span> <span class="toc-text">更新历史</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AC%E8%BD%BD%E5%8E%9F%E6%96%87%E5%89%8D%E8%A8%80"><span class="toc-number">3.</span> <span class="toc-text">转载原文前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A7%E8%87%B4%E6%B5%81%E7%A8%8B"><span class="toc-number">4.</span> <span class="toc-text">大致流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81URL-%E8%A7%A3%E6%9E%90"><span class="toc-number">5.</span> <span class="toc-text">一、URL 解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81DNS-%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.</span> <span class="toc-text">二、DNS 查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81TCP-%E8%BF%9E%E6%8E%A5"><span class="toc-number">7.</span> <span class="toc-text">三、TCP 连接</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%9A%E5%8F%91%E9%80%81-HTTP-%E8%AF%B7%E6%B1%82"><span class="toc-number">7.1.</span> <span class="toc-text">1. 应用层：发送 HTTP 请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BC%A0%E8%BE%93%E5%B1%82%EF%BC%9ATCP-%E4%BC%A0%E8%BE%93%E6%8A%A5%E6%96%87"><span class="toc-number">7.2.</span> <span class="toc-text">2. 传输层：TCP 传输报文</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%9AIP-%E5%8D%8F%E8%AE%AE%E6%9F%A5%E8%AF%A2-Mac-%E5%9C%B0%E5%9D%80"><span class="toc-number">7.3.</span> <span class="toc-text">3. 网络层：IP 协议查询 Mac 地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%93%BE%E8%B7%AF%E5%B1%82%EF%BC%9A%E4%BB%A5%E5%A4%AA%E7%BD%91%E5%8D%8F%E8%AE%AE"><span class="toc-number">7.4.</span> <span class="toc-text">4. 链路层：以太网协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8E%A5%E5%8F%97%E8%AF%B7%E6%B1%82"><span class="toc-number">7.4.1.</span> <span class="toc-text">服务器接受请求</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82"><span class="toc-number">8.</span> <span class="toc-text">四、服务器处理请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8E%A5%E5%8F%97%E5%93%8D%E5%BA%94"><span class="toc-number">9.</span> <span class="toc-text">五、浏览器接受响应</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2"><span class="toc-number">10.</span> <span class="toc-text">六、渲染页面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-HTML-%E8%A7%A3%E6%9E%90"><span class="toc-number">10.1.</span> <span class="toc-text">1.HTML 解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-CSS-%E8%A7%A3%E6%9E%90"><span class="toc-number">10.2.</span> <span class="toc-text">2. CSS 解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%B8%B2%E6%9F%93%E6%A0%91"><span class="toc-number">10.3.</span> <span class="toc-text">3. 渲染树</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%B8%83%E5%B1%80%E4%B8%8E%E7%BB%98%E5%88%B6"><span class="toc-number">10.3.1.</span> <span class="toc-text">4. 布局与绘制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%90%88%E5%B9%B6%E6%B8%B2%E6%9F%93%E5%B1%82"><span class="toc-number">10.3.2.</span> <span class="toc-text">5. 合并渲染层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%9B%9E%E6%B5%81%E4%B8%8E%E9%87%8D%E7%BB%98"><span class="toc-number">10.3.3.</span> <span class="toc-text">6. 回流与重绘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-JavaScript-%E7%BC%96%E8%AF%91%E6%89%A7%E8%A1%8C"><span class="toc-number">10.3.4.</span> <span class="toc-text">7. JavaScript 编译执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90"><span class="toc-number">10.3.5.</span> <span class="toc-text">1. 词法分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%A2%84%E7%BC%96%E8%AF%91"><span class="toc-number">10.3.6.</span> <span class="toc-text">2. 预编译</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%89%A7%E8%A1%8C"><span class="toc-number">10.3.7.</span> <span class="toc-text">3. 执行</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="toc-number">11.</span> <span class="toc-text">参考文档</span></a></li></ol>
		
		</div>
		 -->
		<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>相信大家作为求职者或者面试官大概率都会遇到一道古老的面试问题：当你在浏览器中输入 google.com 并且按下回车之后发生了什么？这个问题可以考察的面非常广，针对不同岗位侧重点也不一样，更重要的是可以根据对方的回答挖掘知识掌握深度。本文授权转载自 @4Ark 的Blog，原文虽然偏向前端但作者整理的内容已经非常全面了，如果各位想深入了解可以访问参考文档。</p>
<blockquote>
<p>在浏览器输入URL回车之后发生了什么</p>
</blockquote>
<hr>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2019年10月16日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/url/">https://wsgzao.github.io/post/url/</a></p>
<p><strong>授权转载</strong></p>
<p><a target="_blank" rel="noopener" href="https://4ark.me/post/b6c7c0a2.html">在浏览器输入 URL 回车之后发生了什么（超详细版）</a></p>
<hr>
<h2 id="转载原文前言"><a href="#转载原文前言" class="headerlink" title="转载原文前言"></a>转载原文前言</h2><p>这个问题已经是老生常谈了，更是经常被作为面试的压轴题出现，网上也有很多文章，但最近闲的无聊，然后就自己做了一篇笔记，感觉比之前理解更透彻了。</p>
<p>这篇笔记是我这两天看了数十篇文章总结出来的，所以相对全面一点，但由于我是做前端的，所以会比较重点分析浏览器渲染页面那一部分，至于其他部分我会罗列出关键词，感兴趣的可以自行查阅，</p>
<p><strong>注意：</strong>本文的步骤是建立在，请求的是一个简单的 HTTP 请求，没有 HTTPS、HTTP2、最简单的 DNS、没有代理、并且服务器没有任何问题的基础上，尽管这是不切实际的。</p>
<h2 id="大致流程"><a href="#大致流程" class="headerlink" title="大致流程"></a><a href="#%E5%A4%A7%E8%87%B4%E6%B5%81%E7%A8%8B" title="大致流程"></a>大致流程</h2><ol>
<li>URL 解析</li>
<li>DNS 查询</li>
<li>TCP 连接</li>
<li>处理请求</li>
<li>接受响应</li>
<li>渲染页面</li>
</ol>
<h2 id="一、URL-解析"><a href="#一、URL-解析" class="headerlink" title="一、URL 解析"></a><a href="#%E4%B8%80%E3%80%81URL-%E8%A7%A3%E6%9E%90" title="一、URL 解析"></a>一、URL 解析</h2><p><strong>地址解析：</strong></p>
<p>首先判断你输入的是一个合法的 URL 还是一个待搜索的关键词，并且根据你输入的内容进行自动完成、字符编码等操作。</p>
<p><strong>HSTS</strong></p>
<p>由于安全隐患，会使用 HSTS 强制客户端使用 HTTPS 访问页面。详见：<a target="_blank" rel="noopener" href="https://www.barretlee.com/blog/2015/10/22/hsts-intro/">你所不知道的 HSTS</a>。</p>
<p><strong>其他操作</strong></p>
<p>浏览器还会进行一些额外的操作，比如安全检查、访问限制（之前国产浏览器限制 996.icu）。</p>
<p><strong>检查缓存</strong></p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150329.png"></p>
<h2 id="二、DNS-查询"><a href="#二、DNS-查询" class="headerlink" title="二、DNS 查询"></a><a href="#%E4%BA%8C%E3%80%81DNS-%E6%9F%A5%E8%AF%A2" title="二、DNS 查询"></a>二、DNS 查询</h2><p><strong>基本步骤</strong></p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150347.png"></p>
<p><strong>1. 浏览器缓存</strong></p>
<p>浏览器会先检查是否在缓存中，没有则调用系统库函数进行查询。</p>
<p><strong>2. 操作系统缓存</strong></p>
<p>操作系统也有自己的 DNS 缓存，但在这之前，会向检查域名是否存在本地的 Hosts 文件里，没有则向 DNS 服务器发送查询请求。</p>
<p><strong>3. 路由器缓存</strong></p>
<p>路由器也有自己的缓存。</p>
<p><strong>4. ISP DNS 缓存</strong></p>
<p>ISP DNS 就是在客户端电脑上设置的首选 DNS 服务器，它们在大多数情况下都会有缓存。</p>
<p><strong>根域名服务器查询</strong></p>
<p>在前面所有步骤没有缓存的情况下，本地 DNS 服务器会将请求转发到互联网上的根域，下面这个图很好的诠释了整个流程：</p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150404.png"></p>
<blockquote>
<p>根域名服务器：<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%A0%B9%E7%B6%B2%E5%9F%9F%E5%90%8D%E7%A8%B1%E4%BC%BA%E6%9C%8D%E5%99%A8">维基百科</a></p>
</blockquote>
<p><strong>需要注意的点</strong></p>
<ol>
<li>递归方式：一路查下去中间不返回，得到最终结果才返回信息（浏览器到本地 DNS 服务器的过程）</li>
<li>迭代方式，就是本地 DNS 服务器到根域名服务器查询的方式。</li>
<li>什么是 DNS 劫持</li>
<li>前端 dns-prefetch 优化</li>
</ol>
<h2 id="三、TCP-连接"><a href="#三、TCP-连接" class="headerlink" title="三、TCP 连接"></a><a href="#%E4%B8%89%E3%80%81TCP-%E8%BF%9E%E6%8E%A5" title="三、TCP 连接"></a>三、TCP 连接</h2><p>TCP&#x2F;IP 分为四层，在发送数据时，每层都要对数据进行封装：</p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150420.png"></p>
<h3 id="1-应用层：发送-HTTP-请求"><a href="#1-应用层：发送-HTTP-请求" class="headerlink" title="1. 应用层：发送 HTTP 请求"></a><a href="#1-%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%9A%E5%8F%91%E9%80%81-HTTP-%E8%AF%B7%E6%B1%82" title="1. 应用层：发送 HTTP 请求"></a><strong>1. 应用层：发送 HTTP 请求</strong></h3><p>在前面的步骤我们已经得到服务器的 IP 地址，浏览器会开始构造一个 HTTP 报文，其中包括：</p>
<ul>
<li>请求报头（Request Header）：请求方法、目标地址、遵循的协议等等</li>
<li>请求主体（其他参数）</li>
</ul>
<p>其中需要注意的点：</p>
<ul>
<li>浏览器只能发送 GET、POST 方法，而打开网页使用的是 GET 方法</li>
</ul>
<h3 id="2-传输层：TCP-传输报文"><a href="#2-传输层：TCP-传输报文" class="headerlink" title="2. 传输层：TCP 传输报文"></a><a href="#2-%E4%BC%A0%E8%BE%93%E5%B1%82%EF%BC%9ATCP-%E4%BC%A0%E8%BE%93%E6%8A%A5%E6%96%87" title="2. 传输层：TCP 传输报文"></a><strong>2. 传输层：TCP 传输报文</strong></h3><p>传输层会发起一条到达服务器的 TCP 连接，为了方便传输，会对数据进行分割（以报文段为单位），并标记编号，方便服务器接受时能够准确地还原报文信息。</p>
<p>在建立连接前，会先进行 TCP 三次握手。</p>
<blockquote>
<p>关于 TCP&#x2F;IP 三次握手，网上已经有很多段子和图片生动地描述了。</p>
<p>相关知识点：</p>
<ol>
<li>SYN 泛洪攻击</li>
</ol>
</blockquote>
<h3 id="3-网络层：IP-协议查询-Mac-地址"><a href="#3-网络层：IP-协议查询-Mac-地址" class="headerlink" title="3. 网络层：IP 协议查询 Mac 地址"></a><a href="#3-%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%9AIP%E5%8D%8F%E8%AE%AE%E6%9F%A5%E8%AF%A2Mac%E5%9C%B0%E5%9D%80" title="3. 网络层：IP协议查询Mac地址"></a><strong>3. 网络层：IP 协议查询 Mac 地址</strong></h3><p>将数据段打包，并加入源及目标的 IP 地址，并且负责寻找传输路线。</p>
<p>判断目标地址是否与当前地址处于同一网络中，是的话直接根据 Mac 地址发送，否则使用路由表查找下一跳地址，以及使用 ARP 协议查询它的 Mac 地址。</p>
<blockquote>
<p>注意：在 OSI 参考模型中 ARP 协议位于链路层，但在 TCP&#x2F;IP 中，它位于网络层。</p>
</blockquote>
<h3 id="4-链路层：以太网协议"><a href="#4-链路层：以太网协议" class="headerlink" title="4. 链路层：以太网协议"></a><a href="#4-%E9%93%BE%E8%B7%AF%E5%B1%82%EF%BC%9A%E4%BB%A5%E5%A4%AA%E7%BD%91%E5%8D%8F%E8%AE%AE" title="4. 链路层：以太网协议"></a><strong>4. 链路层：以太网协议</strong></h3><p><strong>以太网协议</strong></p>
<p>根据以太网协议将数据分为以 “帧” 为单位的数据包，每一帧分为两个部分：</p>
<ul>
<li>标头：数据包的发送者、接受者、数据类型</li>
<li>数据：数据包具体内容</li>
</ul>
<p><strong>Mac 地址</strong></p>
<p>以太网规定了连入网络的所有设备都必须具备 “网卡” 接口，数据包都是从一块网卡传递到另一块网卡，网卡的地址就是 Mac 地址。每一个 Mac 地址都是独一无二的，具备了一对一的能力。</p>
<p><strong>广播</strong></p>
<p>发送数据的方法很原始，直接把数据通过 ARP 协议，向本网络的所有机器发送，接收方根据标头信息与自身 Mac 地址比较，一致就接受，否则丢弃。</p>
<p><strong>注意</strong>：接收方回应是单播。</p>
<blockquote>
<p>相关知识点：</p>
<ol>
<li>ARP 攻击</li>
</ol>
</blockquote>
<h4 id="服务器接受请求"><a href="#服务器接受请求" class="headerlink" title="服务器接受请求"></a><a href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8E%A5%E5%8F%97%E8%AF%B7%E6%B1%82" title="服务器接受请求"></a><strong>服务器接受请求</strong></h4><p>接受过程就是把以上步骤逆转过来，参见上图。</p>
<h2 id="四、服务器处理请求"><a href="#四、服务器处理请求" class="headerlink" title="四、服务器处理请求"></a><a href="#%E5%9B%9B%E3%80%81%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82" title="四、服务器处理请求"></a>四、服务器处理请求</h2><p><strong>大致流程</strong></p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150439.png"></p>
<p><strong>HTTPD</strong></p>
<p>最常见的 HTTPD 有 Linux 上常用的 Apache 和 Nginx，以及 Windows 上的 IIS。</p>
<p>它会监听得到的请求，然后开启一个子进程去处理这个请求。</p>
<p><strong>处理请求</strong></p>
<p>接受 TCP 报文后，会对连接进行处理，对 HTTP 协议进行解析（请求方法、域名、路径等），并且进行一些验证：</p>
<ul>
<li>验证是否配置虚拟主机</li>
<li>验证虚拟主机是否接受此方法</li>
<li>验证该用户可以使用该方法（根据 IP 地址、身份信息等）</li>
</ul>
<p><strong>重定向</strong></p>
<p>假如服务器配置了 HTTP 重定向，就会返回一个 <code>301</code> 永久重定向响应，浏览器就会根据响应，重新发送 HTTP 请求（重新执行上面的过程）。</p>
<blockquote>
<p>关于更多：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/workest/p/3891321.html">详见这篇文章</a></p>
</blockquote>
<p><strong>URL 重写</strong></p>
<p>然后会查看 URL 重写规则，如果请求的文件是真实存在的，比如图片、html、css、js 文件等，则会直接把这个文件返回。</p>
<p>否则服务器会按照规则把请求重写到 一个 REST 风格的 URL 上。</p>
<p>然后根据动态语言的脚本，来决定调用什么类型的动态文件解释器来处理这个请求。</p>
<p>以 PHP 语言的 MVC 框架举例，它首先会初始化一些环境的参数，根据 URL 由上到下地去匹配路由，然后让路由所定义的方法去处理请求。</p>
<h2 id="五、浏览器接受响应"><a href="#五、浏览器接受响应" class="headerlink" title="五、浏览器接受响应"></a><a href="#%E4%BA%94%E3%80%81%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8E%A5%E5%8F%97%E5%93%8D%E5%BA%94" title="五、浏览器接受响应"></a>五、浏览器接受响应</h2><p>浏览器接收到来自服务器的响应资源后，会对资源进行分析。</p>
<p>首先查看 Response header，根据不同状态码做不同的事（比如上面提到的重定向）。</p>
<p>如果响应资源进行了压缩（比如 gzip），还需要进行解压。</p>
<p>然后，对响应资源做缓存。</p>
<p>接下来，根据响应资源里的 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types">MIME</a> 类型去解析响应内容（比如 HTML、Image 各有不同的解析方式）。</p>
<h2 id="六、渲染页面"><a href="#六、渲染页面" class="headerlink" title="六、渲染页面"></a><a href="#%E5%85%AD%E3%80%81%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2" title="六、渲染页面"></a>六、渲染页面</h2><p><strong>浏览器内核</strong></p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150457.png"></p>
<p>不同的浏览器内核，渲染过程也不完全相同，但大致流程都差不多。</p>
<p><strong>基本流程</strong></p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150513.png"></p>
<h3 id="1-HTML-解析"><a href="#1-HTML-解析" class="headerlink" title="1.HTML 解析"></a><a href="#1-HTML-%E8%A7%A3%E6%9E%90" title="1.HTML 解析"></a><strong>1.HTML 解析</strong></h3><p>首先要知道浏览器解析是从上往下一行一行地解析的。</p>
<p>解析的过程可以分为四个步骤：</p>
<p><strong>1. 解码（encoding）</strong></p>
<p>传输回来的其实都是一些二进制字节数据，浏览器需要根据文件指定编码（例如 UTF-8）转换成字符串，也就是 HTML 代码。</p>
<p><strong>2. 预解析（pre-parsing）</strong></p>
<p>预解析做的事情是提前加载资源，减少处理时间，它会识别一些会请求资源的属性，比如 <code>img</code> 标签的 <code>src</code> 属性，并将这个请求加到请求队列中。</p>
<p><strong>3. 符号化（Tokenization）</strong></p>
<p>符号化是词法分析的过程，将输入解析成符号，HTML 符号包括，开始标签、结束标签、属性名和属性值。</p>
<p>它通过一个状态机去识别符号的状态，比如遇到 <code>&lt;</code>，<code>&gt;</code> 状态都会产生变化。</p>
<p><strong>4. 构建树（tree construction）</strong></p>
<blockquote>
<p>注意：符号化和构建树是并行操作的，也就是说只要解析到一个开始标签，就会创建一个 DOM 节点。</p>
</blockquote>
<p>在上一步符号化中，解析器获得这些标记，然后以合适的方法创建 <code>DOM</code> 对象并把这些符号插入到 <code>DOM</code> 对象中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Web page parsing&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;Web page parsing&lt;/h1&gt;</span><br><span class="line">        &lt;p&gt;This is an example Web page.&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150529.png"></p>
<p><strong>浏览器容错进制</strong></p>
<p>你从来没有在浏览器看过类似” 语法无效” 的错误，这是因为浏览器去纠正错误的语法，然后继续工作。</p>
<p><strong>事件</strong></p>
<p>当整个解析的过程完成以后，浏览器会通过 <code>DOMContentLoaded</code> 事件来通知 <code>DOM</code> 解析完成。</p>
<h3 id="2-CSS-解析"><a href="#2-CSS-解析" class="headerlink" title="2. CSS 解析"></a><a href="#2-CSS-%E8%A7%A3%E6%9E%90" title="2. CSS 解析"></a>2. CSS 解析</h3><p>一旦浏览器下载了 CSS，CSS 解析器就会处理它遇到的任何 CSS，根据<a target="_blank" rel="noopener" href="https://drafts.csswg.org/css-syntax-3/">语法规范</a>解析出所有的 CSS 并进行标记化，然后我们得到一个规则表。</p>
<p><strong>CSS 匹配规则</strong></p>
<p>在匹配一个节点对应的 CSS 规则时，是按照从右到左的顺序的，例如：<code>div p &#123; font-size :14px &#125;</code> 会先寻找所有的 <code>p</code> 标签然后判断它的父元素是否为 <code>div</code>。</p>
<p>所以我们写 CSS 时，尽量用 id 和 class，千万不要过度层叠。</p>
<h3 id="3-渲染树"><a href="#3-渲染树" class="headerlink" title="3. 渲染树"></a><a href="#3-%E6%B8%B2%E6%9F%93%E6%A0%91" title="3. 渲染树"></a>3. 渲染树</h3><p>其实这就是一个 DOM 树和 CSS 规则树合并的过程。</p>
<blockquote>
<p>注意：渲染树会忽略那些不需要渲染的节点，比如设置了 <code>display:none</code> 的节点。</p>
</blockquote>
<p><strong>计算</strong></p>
<p>通过计算让任何尺寸值都减少到三个可能之一：<code>auto</code>、百分比、px，比如把 <code>rem</code> 转化为 <code>px</code>。</p>
<p><strong>级联</strong></p>
<p>浏览器需要一种方法来确定哪些样式才真正需要应用到对应元素，所以它使用一个叫做 <code>specificity</code> 的公式，这个公式会通过：</p>
<ol>
<li>标签名、class、id</li>
<li>是否内联样式</li>
<li><code>!important</code></li>
</ol>
<p>然后得出一个权重值，取最高的那个。</p>
<p><strong>渲染阻塞</strong></p>
<p>当遇到一个 <code>script</code> 标签时，DOM 构建会被暂停，直至脚本完成执行，然后继续构建 DOM 树。</p>
<p>但如果 JS 依赖 CSS 样式，而它还没有被下载和构建时，浏览器就会延迟脚本执行，直至 CSS Rules 被构建。</p>
<p>所有我们知道：</p>
<ul>
<li>CSS 会阻塞 JS 执行</li>
<li>JS 会阻塞后面的 DOM 解析</li>
</ul>
<p>为了避免这种情况，应该以下原则：</p>
<ul>
<li>CSS 资源排在 JavaScript 资源前面</li>
<li>JS 放在 HTML 最底部，也就是 <code>&lt;/body&gt;</code> 前</li>
</ul>
<p>另外，如果要改变阻塞模式，可以使用 defer 与 async，详见：<a target="_blank" rel="noopener" href="https://github.com/xiaoyu2er/blog/issues/8">这篇文章</a></p>
<h4 id="4-布局与绘制"><a href="#4-布局与绘制" class="headerlink" title="4. 布局与绘制"></a><a href="#4-%E5%B8%83%E5%B1%80%E4%B8%8E%E7%BB%98%E5%88%B6" title="4. 布局与绘制"></a>4. 布局与绘制</h4><p>确定渲染树种所有节点的几何属性，比如：位置、大小等等，最后输入一个盒子模型，它能精准地捕获到每个元素在屏幕内的准确位置与大小。</p>
<p>然后遍历渲染树，调用渲染器的 paint () 方法在屏幕上显示其内容。</p>
<h4 id="5-合并渲染层"><a href="#5-合并渲染层" class="headerlink" title="5. 合并渲染层"></a><a href="#5-%E5%90%88%E5%B9%B6%E6%B8%B2%E6%9F%93%E5%B1%82" title="5. 合并渲染层"></a><strong>5. 合并渲染层</strong></h4><p>把以上绘制的所有图片合并，最终输出一张图片。</p>
<h4 id="6-回流与重绘"><a href="#6-回流与重绘" class="headerlink" title="6. 回流与重绘"></a><a href="#6-%E5%9B%9E%E6%B5%81%E4%B8%8E%E9%87%8D%E7%BB%98" title="6. 回流与重绘"></a><strong>6. 回流与重绘</strong></h4><p><strong>回流 (reflow)</strong></p>
<p>当浏览器发现某个部分发现变化影响了布局时，需要倒回去重新渲染，会从 <code>html</code> 标签开始递归往下，重新计算位置和大小。</p>
<p>reflow 基本是无法避免的，因为当你滑动一下鼠标、resize 窗口，页面就会产生变化。</p>
<p><strong>重绘 (repaint)</strong></p>
<p>改变了某个元素的背景色、文字颜色等等不会影响周围元素的位置变化时，就会发生重绘。</p>
<p>每次重绘后，浏览器还需要合并渲染层并输出到屏幕上。</p>
<p>回流的成本要比重绘高很多，所以我们应该尽量避免产生回流。</p>
<p>比如：</p>
<ul>
<li><code>display:none</code> 会触发回流，而 <code>visibility:hidden</code> 只会触发重绘。</li>
</ul>
<h4 id="7-JavaScript-编译执行"><a href="#7-JavaScript-编译执行" class="headerlink" title="7. JavaScript 编译执行"></a><a href="#7-JavaScript-%E7%BC%96%E8%AF%91%E6%89%A7%E8%A1%8C" title="7. JavaScript 编译执行"></a>7. JavaScript 编译执行</h4><p><strong>大致流程</strong></p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150545.png"></p>
<p>可以分为三个阶段：</p>
<h4 id="1-词法分析"><a href="#1-词法分析" class="headerlink" title="1. 词法分析"></a><a href="#1-%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90" title="1. 词法分析"></a><strong>1. 词法分析</strong></h4><p>JS 脚本加载完毕后，会首先进入语法分析阶段，它首先会分析代码块的语法是否正确，不正确则抛出 “语法错误”，停止执行。</p>
<p>几个步骤：</p>
<ul>
<li>分词，例如将 <code>var a = 2</code>，，分成 <code>var</code>、<code>a</code>、<code>=</code>、<code>2</code> 这样的词法单元。</li>
<li>解析，将词法单元转换成抽象语法树（AST）。</li>
<li>代码生成，将抽象语法树转换成机器指令。</li>
</ul>
<h4 id="2-预编译"><a href="#2-预编译" class="headerlink" title="2. 预编译"></a><a href="#2-%E9%A2%84%E7%BC%96%E8%AF%91" title="2. 预编译"></a><strong>2. 预编译</strong></h4><p>JS 有三种运行环境：</p>
<ul>
<li>全局环境</li>
<li>函数环境</li>
<li>eval</li>
</ul>
<p>每进入一个不同的运行环境都会创建一个对应的执行上下文，根据不同的上下文环境，形成一个函数调用栈，栈底永远是全局执行上下文，栈顶则永远是当前执行上下文。</p>
<p><strong>创建执行上下文</strong></p>
<p>创建执行上下文的过程中，主要做了以下三件事：</p>
<ul>
<li>创建变量对象<ul>
<li>参数、函数、变量</li>
</ul>
</li>
<li>建立作用域链<ul>
<li>确认当前执行环境是否能访问变量</li>
</ul>
</li>
<li>确定 This 指向</li>
</ul>
<h4 id="3-执行"><a href="#3-执行" class="headerlink" title="3. 执行"></a><a href="#3-%E6%89%A7%E8%A1%8C" title="3. 执行"></a><strong>3. 执行</strong></h4><p><strong>JS 线程</strong></p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150601.png"></p>
<p>虽然 JS 是单线程的，但实际上参与工作的线程一共有四个：</p>
<blockquote>
<p>其中三个只是协助，只有 JS 引擎线程是真正执行的</p>
</blockquote>
<ul>
<li>JS 引擎线程：也叫 JS 内核，负责解析执行 JS 脚本程序的主线程，例如 V8 引擎</li>
<li>事件触发线程：属于浏览器内核线程，主要用于控制事件，例如鼠标、键盘等，当事件被触发时，就会把事件的处理函数推进事件队列，等待 JS 引擎线程执行</li>
<li>定时器触发线程：主要控制 <code>setInterval</code> 和 <code>setTimeout</code>，用来计时，计时完毕后，则把定时器的处理函数推进事件队列中，等待 JS 引擎线程。</li>
<li>HTTP 异步请求线程：通过 XMLHttpRequest 连接后，通过浏览器新开的一个线程，监控 readyState 状态变更时，如果设置了该状态的回调函数，则将该状态的处理函数推进事件队列中，等待 JS 引擎线程执行。</li>
</ul>
<p><strong>注：浏览器对同一域名的并发连接数是有限的，通常为 6 个。</strong></p>
<p><strong>宏任务</strong></p>
<p>分为：</p>
<ul>
<li>同步任务：按照顺序执行，只有前一个任务完成后，才能执行后一个任务</li>
<li>异步任务：不直接执行，只有满足触发条件时，相关的线程将该异步任务推进任务队列中，等待 JS 引擎主线程上的任务执行完毕时才开始执行，例如异步 Ajax、DOM 事件，setTimeout 等。</li>
</ul>
<p><strong>微任务</strong></p>
<p>微任务是 ES6 和 Node 环境下的，主要 API 有：<code>Promise</code>，<code>process.nextTick</code>。</p>
<p>微任务的执行在宏任务的同步任务之后，在异步任务之前。</p>
<p><img src="https://raw.githubusercontent.com/wsgzao/storage-public/master/img/20191016150616.png"></p>
<p><strong>代码例子</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">console.log(&#x27;1&#x27;); // 宏任务 同步</span><br><span class="line"></span><br><span class="line">setTimeout(function() &#123;</span><br><span class="line">    console.log(&#x27;2&#x27;); // 宏任务 异步</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">new Promise(function(resolve) &#123;</span><br><span class="line">    console.log(&#x27;3&#x27;); // 宏任务 同步</span><br><span class="line">    resolve();</span><br><span class="line">&#125;).then(function() &#123;</span><br><span class="line">    console.log(&#x27;4&#x27;) // 微任务</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">console.log(&#x27;5&#x27;) // 宏任务 同步</span><br></pre></td></tr></table></figure>

<p>以上代码输出顺序为：1,3,5,4,2</p>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a><a href="#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3" title="参考文档"></a>参考文档</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/skyline75489/what-happens-when-zh_CN">what-happens-when-zh_CN</a></li>
<li><a target="_blank" rel="noopener" href="https://alistapart.com/article/tags-to-dom/">Tags to DOM</a></li>
<li><a target="_blank" rel="noopener" href="https://heyingye.github.io/2018/04/16/%E5%BD%BB%E5%BA%95%E7%90%86%E8%A7%A3%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6/">彻底理解浏览器的缓存机制</a></li>
<li><a target="_blank" rel="noopener" href="https://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/#The_rendering_engine">浏览器的工作原理：新式网络浏览器幕后揭秘</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.fundebug.com/2019/01/03/understand-browser-rendering/">深入浅出浏览器渲染原理</a></li>
<li><a target="_blank" rel="noopener" href="https://heyingye.github.io/2018/03/19/js%E5%BC%95%E6%93%8E%E7%9A%84%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%EF%BC%88%E4%B8%80%EF%BC%89/#%E9%A2%84%E7%BC%96%E8%AF%91%E9%98%B6%E6%AE%B5">js 引擎的执行过程（一）</a></li>
<li>还有一些找不到了。。。。。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.5udou.cn/blog/Shen-Wei-Qian-Duan-Ni-Bu-De-Bu-Dong-De-Yi-Xie-HTTPZhi-Shi-Fu-Zeng-3Dao-Mian-Shi-Ti-95?hmsr=toutiao.io&utm_medium=toutiao.io&utm_source=toutiao.io#wrapper">身为前端，你不得不懂的一些HTTP知识(附赠3道面试题)</a></p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0-Study/">学习 | Study</a>
</div>


</div>



	<div class="article-share" id="share">
	
	  <div data-url="https://wsgzao.github.io/post/url/" data-title="在浏览器输入URL回车之后发生了什么 | HelloDog" data-tsina="" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/post/fliggy/" title="飞猪F3会员特价入住成都东大明宇豪雅饭店免费升级行政套房的体验报告">
  <strong>上一篇：</strong><br/>
  <span>
  飞猪F3会员特价入住成都东大明宇豪雅饭店免费升级行政套房的体验报告</span>
</a>
</div>


<div class="next">
<a href="/post/trimlog/"  title="基于bash shell脚本制定灵活的trimlog日志清理策略">
 <strong>下一篇：</strong><br/> 
 <span>基于bash shell脚本制定灵活的trimlog日志清理策略
</span>
</a>
</div>

</nav>

	

<section id="comments" class="comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%8E%86%E5%8F%B2"><span class="toc-number">2.</span> <span class="toc-text">更新历史</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AC%E8%BD%BD%E5%8E%9F%E6%96%87%E5%89%8D%E8%A8%80"><span class="toc-number">3.</span> <span class="toc-text">转载原文前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A7%E8%87%B4%E6%B5%81%E7%A8%8B"><span class="toc-number">4.</span> <span class="toc-text">大致流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81URL-%E8%A7%A3%E6%9E%90"><span class="toc-number">5.</span> <span class="toc-text">一、URL 解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81DNS-%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.</span> <span class="toc-text">二、DNS 查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81TCP-%E8%BF%9E%E6%8E%A5"><span class="toc-number">7.</span> <span class="toc-text">三、TCP 连接</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%9A%E5%8F%91%E9%80%81-HTTP-%E8%AF%B7%E6%B1%82"><span class="toc-number">7.1.</span> <span class="toc-text">1. 应用层：发送 HTTP 请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BC%A0%E8%BE%93%E5%B1%82%EF%BC%9ATCP-%E4%BC%A0%E8%BE%93%E6%8A%A5%E6%96%87"><span class="toc-number">7.2.</span> <span class="toc-text">2. 传输层：TCP 传输报文</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%9AIP-%E5%8D%8F%E8%AE%AE%E6%9F%A5%E8%AF%A2-Mac-%E5%9C%B0%E5%9D%80"><span class="toc-number">7.3.</span> <span class="toc-text">3. 网络层：IP 协议查询 Mac 地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%93%BE%E8%B7%AF%E5%B1%82%EF%BC%9A%E4%BB%A5%E5%A4%AA%E7%BD%91%E5%8D%8F%E8%AE%AE"><span class="toc-number">7.4.</span> <span class="toc-text">4. 链路层：以太网协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8E%A5%E5%8F%97%E8%AF%B7%E6%B1%82"><span class="toc-number">7.4.1.</span> <span class="toc-text">服务器接受请求</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82"><span class="toc-number">8.</span> <span class="toc-text">四、服务器处理请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8E%A5%E5%8F%97%E5%93%8D%E5%BA%94"><span class="toc-number">9.</span> <span class="toc-text">五、浏览器接受响应</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2"><span class="toc-number">10.</span> <span class="toc-text">六、渲染页面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-HTML-%E8%A7%A3%E6%9E%90"><span class="toc-number">10.1.</span> <span class="toc-text">1.HTML 解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-CSS-%E8%A7%A3%E6%9E%90"><span class="toc-number">10.2.</span> <span class="toc-text">2. CSS 解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%B8%B2%E6%9F%93%E6%A0%91"><span class="toc-number">10.3.</span> <span class="toc-text">3. 渲染树</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%B8%83%E5%B1%80%E4%B8%8E%E7%BB%98%E5%88%B6"><span class="toc-number">10.3.1.</span> <span class="toc-text">4. 布局与绘制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%90%88%E5%B9%B6%E6%B8%B2%E6%9F%93%E5%B1%82"><span class="toc-number">10.3.2.</span> <span class="toc-text">5. 合并渲染层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%9B%9E%E6%B5%81%E4%B8%8E%E9%87%8D%E7%BB%98"><span class="toc-number">10.3.3.</span> <span class="toc-text">6. 回流与重绘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-JavaScript-%E7%BC%96%E8%AF%91%E6%89%A7%E8%A1%8C"><span class="toc-number">10.3.4.</span> <span class="toc-text">7. JavaScript 编译执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90"><span class="toc-number">10.3.5.</span> <span class="toc-text">1. 词法分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%A2%84%E7%BC%96%E8%AF%91"><span class="toc-number">10.3.6.</span> <span class="toc-text">2. 预编译</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%89%A7%E8%A1%8C"><span class="toc-number">10.3.7.</span> <span class="toc-text">3. 执行</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="toc-number">11.</span> <span class="toc-text">参考文档</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="wsgzao" data-theme="medium"></div>
<script type="text/javascript" src="//lab.lepture.com/github-cards/widget.js" ></script>
</div>



  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/Hexo/" title="Hexo">Hexo<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/学习-Study/" title="学习 | Study">学习 | Study<sup>193</sup></a></li>
		  
		
		  
			<li><a href="/categories/生活-Life/" title="生活 | Life">生活 | Life<sup>26</sup></a></li>
		  
		
		  
			<li><a href="/categories/软件-Soft/" title="软件 | Soft">软件 | Soft<sup>5</sup></a></li>
		  
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.linkedin.com/in/aowang" target="_blank" title="LinkedIn">LinkedIn</a>
            
          </li>
        
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello, I&#39;m OX. This is my blog on GitHub. <br/>
			Keep Calm and Carry On.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/wsgzao" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		<a href="https://www.linkedin.com/in/aowang" target="_blank" class="icon-linkedin" title="linkedin"></a>
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2023 
		
		<a href="/about" target="_blank" title="wsgzao">wsgzao</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-3.6.4.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery-qrcode-0.18.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
        getSize();
        if (myWidth >= 1024) {
          c.click();
        }
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>




<script type="text/javascript">

var disqus_shortname = 'wsgzao';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>








<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-77732745-1', 'wsgzao.github.io');  
ga('send', 'pageview');
</script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?c2c5fc7d844d0973d9f77abd87f49c3c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- swiftype Begin -->

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','_4qDmKrBPn9Es3UvQHT4','2.0.0');
</script>

<!-- swiftype End -->

  </body>
</html>
